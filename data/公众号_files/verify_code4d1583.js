define("pages/modules/base/polyfill/promise.js",[],function(t,n,e){"use strict"
var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}
!function(t){function n(t){return"[object Array]"===Object.prototype.toString.call(t)}function e(){for(var t=0;t<j.length;t++)j[t][0](j[t][1])
j=[],d=!1}function r(t,n){j.push([t,n]),d||(d=!0,g(e,0))}function i(t){var n=t.owner,e=n.state_,o=n.data_,r=t[e],i=t.then
if("function"==typeof r){e=v
try{o=r(o)}catch(t){a(i,t)}}f(i,o)||(e===v&&c(i,o),e===_&&a(i,o))}function f(t,n){var e
try{if(t===n)throw new TypeError("A promises callback cannot return that same promise.")
if(n&&("function"==typeof n||"object"===(void 0===n?"undefined":o(n)))){var r=n.then
if("function"==typeof r)return r.call(n,function(o){e||(e=!0,n!==o?c(t,o):u(t,o))},function(n){e||(e=!0,a(t,n))}),!0}}catch(n){return e||a(t,n),!0}return!1}function c(t,n){t!==n&&f(t,n)||u(t,n)}function u(t,n){t.state_===m&&(t.state_=w,t.data_=n,r(l,t))}function a(t,n){t.state_===m&&(t.state_=w,t.data_=n,r(h,t))}function s(t){var n=t.then_
t.then_=void 0
for(var e=0;e<n.length;e++)i(n[e])}function l(t){t.state_=v,s(t)}function h(t){t.state_=_,s(t)}function p(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument")
if(this instanceof p==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")
this.then_=[],function(t,n){function e(t){a(n,t)}try{t(function(t){c(n,t)},e)}catch(t){e(t)}}(t,this)}var y=t.Promise
if(!(y&&"resolve"in y&&"reject"in y&&"all"in y&&"race"in y&&function(){var t
return new y(function(n){t=n}),"function"==typeof t}())){t.Promise=p
var d,m="pending",w="sealed",v="fulfilled",_="rejected",b=function(){},g="undefined"!=typeof setImmediate?setImmediate:setTimeout,j=[]
p.prototype={constructor:p,state_:m,then_:null,data_:void 0,then:function(t,n){var e={owner:this,then:new this.constructor(b),fulfilled:t,rejected:n}
return this.state_===v||this.state_===_?r(i,e):this.then_.push(e),e.then},catch:function(t){return this.then(null,t)}},p.all=function(t){if(!n(t))throw new TypeError("You must pass an array to Promise.all().")
return new this(function(n,e){function o(t){return f++,function(e){i[t]=e,--f||n(i)}}for(var r,i=[],f=0,c=0;c<t.length;c++)(r=t[c])&&"function"==typeof r.then?r.then(o(c),e):i[c]=r
f||n(i)})},p.race=function(t){if(!n(t))throw new TypeError("You must pass an array to Promise.race().")
return new this(function(n,e){for(var o,r=0;r<t.length;r++)(o=t[r])&&"function"==typeof o.then?o.then(n,e):n(o)})},p.resolve=function(t){return t&&"object"===(void 0===t?"undefined":o(t))&&t.constructor===this?t:new this(function(n){n(t)})},p.reject=function(t){return new this(function(n,e){e(t)})}}}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:void 0)})
define("pages/modules/base/polyfill/array.js",[],function(r,e,t){"use strict"
Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(r){if(null==this)throw new TypeError('"this" is null or not defined')
var e=Object(this),t=e.length>>>0
if("function"!=typeof r)throw new TypeError("predicate must be a function")
for(var n=arguments[1],i=0;i<t;){var o=e[i]
if(r.call(n,o,i,e))return i
i++}return-1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(r){if(null==this)throw new TypeError('"this" is null or not defined')
var e=Object(this),t=e.length>>>0
if("function"!=typeof r)throw new TypeError("predicate must be a function")
for(var n=arguments[1],i=0;i<t;){var o=e[i]
if(r.call(n,o,i,e))return o
i++}}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(r,e){if(null==this)throw new TypeError('"this" is null or not defined')
var t=Object(this),n=t.length>>>0
if(0===n)return!1
for(var i=0|e,o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;){if(t[o]===r)return!0
o++}return!1}})})
define("pages/modules/base/polyfill/string.js",[],function(t,r,e){"use strict"
String.prototype.includes||(String.prototype.includes=function(t,r){return"number"!=typeof r&&(r=0),!(r+t.length>this.length)&&-1!==this.indexOf(t,r)}),String.prototype.startsWith||function(){var t=function(){try{var t={},r=Object.defineProperty,e=r(t,t,t)&&r}catch(t){}return e}(),r={}.toString,e=function(t){if(null==this)throw TypeError()
var e=String(this)
if(t&&"[object RegExp]"==r.call(t))throw TypeError()
var n=e.length,i=String(t),o=i.length,a=arguments.length>1?arguments[1]:void 0,h=a?Number(a):0
h!=h&&(h=0)
var s=Math.min(Math.max(h,0),n)
if(o+s>n)return!1
for(var u=-1;++u<o;)if(e.charCodeAt(s+u)!=i.charCodeAt(u))return!1
return!0}
t?t(String.prototype,"startsWith",{value:e,configurable:!0,writable:!0}):String.prototype.startsWith=e}()})
"use strict"
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}
!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define?define("3rd/mplogd/mplogd.js",[],e):(t=t||self).Mplogd=e()}(void 0,function(){var o="initing",i="inited",c="failed",s=0,l=1,u=2,d=3,r="info",n="warn",a="error",h=["report"],p=["spellingcheck","badjs","mplog","webcommreport"]
function f(t){return(t=t.toString())[1]?t:"0"+t}function g(t){var e=""
return/^[0-9]{4}-[0-9]{2}-[0-9]{2}/.test(t)?e+=new Date(t).getTime():/^\d{13}$/.test(t)?e+=t:/^\d{10}$/.test(t)&&(e+=1e3*parseInt(t,10)),parseInt(e,10)}function m(i,a,s,u){return new(s=s||Promise)(function(t,e){function r(t){try{n(u.next(t))}catch(t){e(t)}}function o(t){try{n(u.throw(t))}catch(t){e(t)}}function n(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(r,o)}n((u=u.apply(i,a||[])).next())})}function y(r,o){var n,i,a,t,s={label:0,sent:function(){if(1&a[0])throw a[1]
return a[1]},trys:[],ops:[]}
return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t
function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.")
for(;s;)try{if(n=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a
switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e
break
case 4:return s.label++,{value:e[1],done:!1}
case 5:s.label++,i=e[1],e=[0]
continue
case 7:e=s.ops.pop(),s.trys.pop()
continue
default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){s=0
continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1]
break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e
break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e)
break}a[2]&&s.ops.pop(),s.trys.pop()
continue}e=o.call(r,s)}catch(t){e=[6,t],i=0}finally{n=a=0}if(5&e[0])throw e[1]
return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function v(o){return void 0===o&&(o=4e7),m(this,void 0,void 0,function(){return y(this,function(t){try{return window.navigator&&window.navigator.storage&&window.navigator.storage.estimate?[2,window.navigator.storage.estimate().then(function(t){var e=t.quota,r=t.usage
return e<=r||o<=r})]:window.navigator&&window.navigator.webkitTemporaryStorage&&window.navigator.webkitTemporaryStorage.queryUsageAndQuota?[2,new Promise(function(r,t){window.navigator.webkitTemporaryStorage.queryUsageAndQuota(function(t,e){r(e<t||o<=t)})}).then(function(t){return t})]:[2,!1]}catch(t){return[2,!1]}return[2]})})}var b=["enough space","full disk","Maximum key generator","large IndexedDB value"]
var x="readwrite",e=(t.prototype.init=function(){try{this.createDB()}catch(t){console.log("Mplog createDB failed")}},t.prototype.createDB=function(){return m(this,void 0,void 0,function(){var e,n=this
return y(this,function(t){switch(t.label){case 0:return this.indexedDB?this.dbStatus!==o?(this.currentRetryCount=this.maxRetryCount+1,this.throwError(d,"indexedDB init error"),[2]):[4,v(1e8)]:(this.currentRetryCount=this.maxRetryCount+1,this.throwError(d,"your browser not support IndexedDB."),[2])
case 1:return t.sent()?(this.dbStatus=c,this.currentRetryCount=this.maxRetryCount+1,this.throwError(d,"this db size is too large")):(this.throwError(s,"this db size is lower than 100MB"),(e=indexedDB.open(this.DB_NAME,this.DB_VERSION)).onerror=function(t){n.checkDB(t)
var e=d
if(t.target.error&&"VersionError"===t.target.error.name){try{var r=t.target.error.message
if(-1<r.search(/The requested version \([0-9]+\) is less than the existing version \([0-9]\)/)){var o=r.match(/[0-9]+/gi)[1]
o>n.DB_VERSION&&(n.DB_VERSION=o)}}catch(t){console.log(t)}n.dbStatus=c}n.throwError(e,"indexedDB open error",t.target.error)},e.onsuccess=function(r){return m(n,void 0,void 0,function(){var e=this
return y(this,function(t){if(this.dbStatus!==o)return[2]
this.db=r.target.result,this.dbStatus=i,this.db.onerror=function(t){return e.throwError(d,"indexedDB error",t.target.error)},this.db.onversionchange=function(t){e.db.close(),e.dbStatus=c,e.currentRetryCount=e.maxRetryCount+1,e.throwError(d,"indexedDB version change",t.target.error)}
try{this.poolHandler.consume()}catch(t){this.throwError(d,"consume pool error",t)}return this.keep7Days&&setTimeout(function(){e.dbStatus!==i?e.poolHandler.push(function(){return e.keep(3)}):e.keep(3)},1e3),[2]})})},e.onblocked=function(){n.throwError(d,"indexedDB is blocked")},e.onupgradeneeded=function(t){n.db=t.target.result
try{if("function"==typeof n.onupgradeneeded)n.onupgradeneeded(t)
else if(!n.db.objectStoreNames.contains(n.DB_STORE_NAME)){var e=n.db.createObjectStore(n.DB_STORE_NAME,{autoIncrement:!0})
e.createIndex("location","location",{unique:!1}),e.createIndex("level","level",{unique:!1}),e.createIndex("description","description",{unique:!1}),e.createIndex("data","data",{unique:!1}),e.createIndex("timestamp","timestamp",{unique:!1})}}catch(t){n.dbStatus=c,n.throwError(d,"indexedDB upgrade error",t)}}),[2]}})})},t.prototype.checkCurrentStorage=function(){return m(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,v()]
case 1:return t.sent()&&this.clean(),[2]}})})},t.prototype.checkDB=function(t){t&&t.target&&t.target.error&&"QuotaExceededError"===t.target.error.name&&this.clean()},t.prototype.getTransaction=function(t){var e=this,r=null
if(this.dbStatus===c)r=null
else{try{r=this.db.transaction(this.DB_STORE_NAME,t)}catch(t){r=null}r&&(r.onerror=function(t){return t.stopPropagation(),e.throwError(d,"transaction is error")},r.onabort=function(t){t.stopPropagation(),e.checkDB(t)})}return r},t.prototype.insertItems=function(u){return m(this,void 0,void 0,function(){var e,r,o,n,i,a,s=this
return y(this,function(t){switch(t.label){case 0:return[4,this.checkCurrentStorage()]
case 1:if(t.sent(),this.isCleaned)return[2]
for(null===(r=this.getTransaction(x))&&this.throwError(d,"transaction is null"),o=r.objectStore(this.DB_STORE_NAME),n=0,i=u;n<i.length;n++)a=i[n],(e=o.put(a)).onsuccess=function(){},e.onerror=function(t){s.checkDB(t),s.throwError(l,"add log failed",t.target.error)}
return[2]}})})},t.prototype.get=function(t,e,r,o){var n=this.getTransaction(x)
if(null===n)return this.throwError(d,"transaction is null"),!1
var i=(new Date).getTime(),a=(new Date).getTime()
try{i=g(t),a=g(e)}catch(t){this.throwError(l,"invalid time")}var s=n.objectStore(this.DB_STORE_NAME),u=[]
try{var c=IDBKeyRange.bound(i,a),h=s.index("timestamp").openCursor(c)
"function"==typeof o?h.onsuccess=function(t){o(t)}:"function"==typeof r&&(h.onsuccess=function(t){var e=t.target.result
e?(u.push({time:e.value.time,level:e.value.level,location:e.value.location,description:e.value.description,data:e.value.data,timestamp:e.value.timestamp}),e.continue()):r(u)})}catch(t){this.throwError(d,"get action error",t)}return!0},t.prototype.clean=function(){var o=this
this.db&&this.db.close(),this.isCleaned=!0
var t=this.indexedDB.deleteDatabase(this.DB_NAME)
t.onerror=function(t){if(o.dbStatus=c,o.currentRetryCount=o.maxRetryCount+1,o.BadJsReport){var e=t.target.error,r="clean database fail"
e&&(r=r+":"+(e.message||e.stack||e.name)),o.BadJsReport(r,"")}},t.onsuccess=function(){o.dbStatus=c,o.currentRetryCount=o.maxRetryCount+1,o.BadJsReport&&o.BadJsReport("clean database success","")}},t.prototype.keep=function(t){var r=this,e=this.getTransaction(x)
if(null!==e){var o=e.objectStore(this.DB_STORE_NAME)
if(t)try{var n=Date.now()-60*t*60*24*1e3,i=IDBKeyRange.upperBound(n)
if(o.indexNames&&o.indexNames.length&&o.indexNames.contains("timestamp")){var a=o.index("timestamp").openCursor(i)
a.onsuccess=function(t){r.throwError(s,"keep logs success")
var e=t.target.result
e&&(e.delete(),e.continue())},a.onerror=function(t){return r.throwError(l,"keep logs error",t.target.error)}}else this.throwError(d,"the store has no timestamp index")}catch(t){this.throwError(d,"keep logs error",t)}else o.clear().onerror=function(t){return r.throwError(u,"indexedb_keep_clear",t.target.error)}}else this.throwError(d,"transaction is null")},t.prototype.throwError=function(t,e,r){var o=this
this.currentErrorNum+=t,this.currentErrorNum>=this.maxErrorNum&&(this.dbStatus=c,this.poolHandler.pool=[],this.currentErrorNum=0)
var n,i,a,s=""
r&&(e=e+":"+(r.message||r.stack||r.name),s=r.toString()),t&&console.error&&console.error("Mplog: error msg: "+e+", error detail: "+s)
try{if(this.BadJsReport){var u="Mplog: error msg: "+e+", error detail: "+s
this.BadJsReport(e,u)}}catch(t){}n=s||e,a=!1,(i=b).length&&i.forEach(function(t){-1<n.indexOf(t)&&(a=!0)}),a?this.clean():this.dbStatus===c&&(this.timer=setInterval(function(){o.retryDBConnection()},this.retryInterval))},t.prototype.retryDBConnection=function(){this.currentRetryCount++,this.currentRetryCount>this.maxRetryCount?(this.dbStatus=c,this.poolHandler.pool=[]):(this.dbStatus=o,this.createDB()),clearInterval(this.timer)},t)
function t(t,e){this.defaultDbName="mplog__"+wx.uin,this.defaultDbStoreName="logs",this.dbStatus=o,this.currentErrorNum=0,this.maxRetryCount=3,this.currentRetryCount=0,this.retryInterval=6e3,this.isCleaned=!1,this.MAX_CLEAN_TIME=2,this.currentCleanTime=0,this.DB_NAME=t&&t.dbName?t.dbName:this.defaultDbName,this.DB_STORE_NAME=t&&t.dbStoreName?t.dbStoreName:this.defaultDbStoreName,this.DB_VERSION=t&&void 0!==t.dbVersion?t.dbVersion:6,this.indexedDB=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.msIndexedDB,this.onupgradeneeded=t&&t.onupgradeneeded?t.onupgradeneeded:null,this.maxErrorNum=t&&t.maxErrorNum?t.maxErrorNum:3,this.poolHandler=e,this.keep7Days=!t||!t.keep7Days||t.keep7Days,this.BadJsReport=t&&t.BadJsReport?t.BadJsReport:null,this.init()}var w=(E.prototype.push=function(t){this.pool.length<this.poolSize&&this.pool.push(t)},E.prototype.consume=function(){for(var t=this.pool.shift();t;)t(),t=this.pool.shift()},E)
function E(){this.poolSize=20,this.pool=[]}var D=(S.prototype.log=function(t,e,r,o){var n,i,a,s,u,c,h,l=new Date,d={time:(i=(n=l).getFullYear(),a=n.getMonth()+1,s=n.getDate(),u=n.getHours(),c=n.getMinutes(),h=n.getSeconds(),[i,a,s].map(f).join("-")+" "+[u,c,h].map(f).join(":")),location:t,level:e,description:r,data:this.dealLength(this.filterFunction(o)),timestamp:l.getTime()}
this.bufferLog.push(d),this.bufferLog.length>=this.bufferSize&&(this.flush(this.bufferLog),this.bufferLog=[])},S.prototype.dealLength=function(t){return"number"==typeof this.maxLogSize&&"string"==typeof t&&t.length>=this.maxLogSize&&(t=t.substr(0,this.maxLogSize)),t},S.prototype.filterFunction=function(t){try{return"number"==typeof t||"boolean"==typeof t?""+t:"string"==typeof t?t:""}catch(t){console.log(t)}},S.prototype.flush=function(t){var e=this
return void 0===t&&(t=this.bufferLog),0!==t.length&&(this.mpIndexedDB.dbStatus!==i?this.poolHandler.push(function(){return e.flush(t)}):(this.mpIndexedDB.insertItems(t),0))},S.prototype.get=function(t,e,r,o){var n=this
if(this.mpIndexedDB.dbStatus!==i)return this.poolHandler.push(function(){return n.get(t,e,r,o)})
this.mpIndexedDB.get(t,e,r,o)},S.prototype.keep=function(t){var e=this
if(this.mpIndexedDB.dbStatus!==i)return this.poolHandler.push(function(){return e.keep(t)})
this.mpIndexedDB.keep(t)},S)
function S(t){this.bufferLog=[],this.bufferSize=t&&void 0!==t.bufferSize?+t.bufferSize:10,this.maxLogSize=t&&t.maxLogSize?t.maxLogSize:1e3,this.poolHandler=new w,this.mpIndexedDB=new e(t,this.poolHandler)}function B(t){this.defaultAjaxFilter=function(t){if(t){var e,r=!0,o=!1,n=void 0
try{for(var i,a=p[Symbol.iterator]();!(r=(i=a.next()).done);r=!0)if(e=i.value,-1<t.indexOf(e))return!1}catch(t){o=!0,n=t}finally{try{!r&&a.return&&a.return()}finally{if(o)throw n}}if(-1<h.indexOf(((s=t).match(/\/[A-Za-z]+\?/)&&(u=(u=s.match(/\/[A-Za-z]+\?/)[0]).replace("?","").replace("/","")),u)))return!1}var s,u
return!0},this.xhrOpen=XMLHttpRequest.prototype.open,this.xhrSend=XMLHttpRequest.prototype.send,this.location=t&&t.location?t.location:window.location.href,this.autoLogError=!(!t||void 0===t.autoLogError)&&t.autoLogError,this.autoLogRejection=!(!t||void 0===t.autoLogRejection)&&t.autoLogRejection,this.autoLogAjax=!(!t||void 0===t.autoLogAjax)&&t.autoLogAjax,this.logAjaxFilter=t&&t.logAjaxFilter&&t.logAjaxFilter?t.logAjaxFilter:this.defaultAjaxFilter,this.logController=new D(t),this.bindEvent()}return B.prototype.bindEvent=function(){var e=this
this.autoLogError&&window.addEventListener("error",function(t){e.error("[OnError]: "+t.message,"("+t.lineno+'_("行")'+t.colno+'_("列"))')}),this.autoLogRejection&&window.addEventListener("unhandledrejection",function(t){e.error("[OnRejection]:",t.reason)}),this.ajaxHanler(),this.saveUnstoreData()},B.prototype.ajaxHanler=function(){if(this.autoLogAjax){var i,a,s=this
XMLHttpRequest.prototype.open=function(){for(var t,e,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o]
i=r[0],t=r[1],(e=document.createElement("a")).href=t,a=e.protocol+"//"+e.host+e.pathname+e.search+e.hash,s.xhrOpen.apply(this,r)},XMLHttpRequest.prototype.send=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t]
var o=(new Date).getTime(),n=+new Date
if(s.logAjaxFilter&&s.logAjaxFilter(a,i)||!s.logAjaxFilter){var e="[ajax] id:"+n+" request "+a+" "+i
"post"===i.toLowerCase()?s.info(e,r[0]):s.info(e)}this.addEventListener("readystatechange",function(){var e=""
if(s.logAjaxFilter&&s.logAjaxFilter(a,i)||!s.logAjaxFilter)try{if(this.readyState===XMLHttpRequest.DONE){var t=((new Date).getTime()-o)/1e3
s.info("[ajax] id:"+n+" response "+this.status+" "+a+" "+t,this.responseText)}}catch(t){e="[ajax] id:"+n+" response "+this.status+" "+a,"post"===i.toLowerCase()?s.error(e,r[0]):s.error(e)}}),s.xhrSend.apply(this,r)}}},B.prototype.saveUnstoreData=function(){var e=this
window.addEventListener("beforeunload",function(t){try{e.logController.flush()}catch(t){console.log(t)}return null})},B.prototype.info=function(t,e){this.logController.log(this.location,r,t,e)},B.prototype.warn=function(t,e){this.logController.log(this.location,n,t,e)},B.prototype.error=function(t,e){this.logController.log(this.location,a,t,e)},B.prototype.get=function(t,e,r,o){this.logController.get(t,e,r,o)},B.prototype.keep=function(t){this.logController.keep(t)},B})
"use strict"
define("pages/modules/mplog/uplog.js",["3rd/mplogd/mplogd.js","pages/modules/utils/cgi.js","pages/modules/mplog/notify.js"],function(e,t,a){var n=e("3rd/mplogd/mplogd.js"),s=e("pages/modules/utils/cgi.js"),d=e("pages/modules/mplog/notify.js"),o="mplog__"+wx.uin,l="logs",i=window.wx.commonData.mplog,r=i.needUplog,u=void 0!==r&&r,f=i.beginTime,p=void 0===f?0:f,c=i.endTime,g=void 0===c?0:c,m=i.uploadCGIName,v=void 0===m?"":m,y=v.split(","),h=["info","error","warn"],w={unload:"未上传",loading:"上传中",loaded:"已上传",failed:"上传失败"},_=2,b=18e5,T=1e6,O=[[]],j=null,x=1,S=[]
function D(){return!(!i||!u)&&!(!p||!g||g<=p)}function N(e){var t=""
return e.match(/\/[A-Za-z]+\?/)&&(t=(t=e.match(/\/[A-Za-z]+\?/)[0]).replace("?","").replace("/","")),t}function E(e){return function(e){if(!v||""===v)return!0
var t=N(e.value.location)
return!!(t&&-1<y.indexOf(t))}(e)}function M(i,n){j.get(p,g,null,function(e){var t=e.target.result
if(t){if(function(e,t){var a=!0,i=!1,n=void 0
try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){if(o.value.id===t)return 1}}catch(e){i=!0,n=e}finally{try{!a&&l.return&&l.return()}finally{if(i)throw n}}}(i,t.primaryKey)){var a=t.value
a.status=n,a.statusChangeTime=(new Date).getTime(),n===w.failed&&(a.failTimes=a.failTimes?++a.failTimes:1),t.update(a)}t.continue()}})}function A(){if(1!==O.length||0!==O[0].length)for(var l=0,r=O.length,u=[],e=function(e){M(O[e],w.loading),u=O[e]
for(var t=[],a=0;a<O[e].length;a++){var i=O[e][a]
t.push({interface:"mp_log",busid:"b_wxg_wxplat_wxapp_realtime_log",data:JSON.stringify(i.data)})}var n,o=(n=u,function(){s.post({url:"/advanced/mplog?action=up",data:{need_verify:x,log:JSON.stringify({data:t}),logid:e}},function(e){return a=n,void((t=e)&&t.base_resp&&0===t.base_resp.ret?(M(a,w.loaded),++l===r&&(x&&s.post({url:"/advanced/mplog?action=up",data:{end:1,need_verify:x}}),d.notify("uploadSuccess"),console.log("上传成功"))):(t&&t.base_resp&&200007===t.base_resp.ret?d.notify("noPermit"):d.notify("uploadFail"),M(a,w.failed)))
var t,a},function(){return M(n,w.failed),void d.notify("uploadFail")},null)})
d.notify("begin upload"),o()},t=0;t<O.length;t++)e(t)
else d.notify("emptyLog")}function B(){return new Promise(function(l){var r=0
j.get(p,g,null,function(e){var t,a,i=e.target.result
if(i){if(d.notify("success get"),S.push({time:i.value.time,level:i.value.level,location:i.value.location,description:i.value.description,data:i.value.data,timestamp:i.value.timestamp}),E(i)){var n=i.value
if(n.status){if(n.status===w.loading){var o=n.statusChangeTime
t=o,a=(new Date).getTime(),b<a-t&&(n.status=w.unload,n.beginLoadTime=null)}else if(n.status===w.failed){n.failTimes<_&&(n.status=w.unload,0)}}else n.status=w.unload,0
if(!0)i.update(n),"[object Object]"===Object.prototype.toString.call(n.data)?n.data=JSON.stringify(n.data):"[object String]"!==Object.prototype.toString.call(n.data)&&(n.data+=""),n.timestamp=parseInt(n.timestamp/1e3,10),function(e,t){var a=t.data,i=[],n=Math.ceil(a.length/1e4)
if(!a||1===n)return i.push({id:e.primaryKey,data:{time:Math.ceil(new Date/1e3),dataTime:t.timestamp,level:h.indexOf(t.level),location:N(t.location),description:t.description,msg:a,uin:""+wx.uin}}),i
for(var o=0;o<n;o++){var l
l=JSON.stringify({index:o,data:o===n-1?a.substr(1e4*o):a.substr(1e4*o,1e4)}),i.push({id:e.primaryKey,data:{time:Math.ceil(new Date/1e3),dataTime:t.timestamp,level:h.indexOf(t.level),location:N(t.location),description:t.description,msg:l,uin:""+wx.uin}})}return i}(i,n).forEach(function(e){var t=JSON.stringify(e).length
T<=t+r?(O.push([e]),r=t):(O[O.length-1].push(e),r+=t)})}i.continue()}else A(),l(S)})})}return{uploadLogs:function(){D()&&"mplog"!==N(window.location.href)&&(O=[[]],j=new n({DB_NAME:o,DB_STORE_NAME:l}),B())},initiativeUploadLog:function(e){return x=0,a=(t=e).setBeginTime,i=t.setEndTime,u=!0,g=a&&i?(p=a,i):(p=parseInt(new Date/1e3,10)-86400,parseInt(new Date/1e3,10)),v="",D()?(O=[[]],S=[],j=new n({DB_NAME:o,DB_STORE_NAME:l}),B()):null
var t,a,i}}})
define("pages/modules/utils/cgi.js",["pages/modules/utils/ajax.js","pages/modules/utils/str_util.js","pages/modules/utils/object.js","pages/modules/utils/url.js"],function(e,r,t){"use strict"
function a(e){for(var r=e||{},t=Object.keys(m),o=0;o<t.length;o++)r[t[o]]=m[t[o]]
return r}function n(e,r){var t=-1!==location.href.indexOf("/cgi-bin/home")&&(-1!==r.url.indexOf("/misc/safeassistant")||-1!==r.url.indexOf("/safe/safeuuid")),o=11
switch(e){case"timeout":o=7
break
case"error":o=8
break
case"notmodified":o=9
break
case"parsererror":o=10
break
default:o=11}for(var a=["lang","random","f","ajax","token"],n=0;n<a.length;++n){var s=a[n]
r.data&&r.data[s]&&delete r.data[s]}o+=t?100:0
var i=""
i=/selfcheck/.test(r.url)?r.data&&r.data.AppMsgId:JSON.stringify(r.data).substr(0,50),u({url:"/misc/jslog?1=1",data:{content:l.format("[fakeid={uin}] [xhr] [url={url}] [param={param}] [info={info}] [useragent={useragent}] [page={page}]",{uin:p.uin,useragent:window.navigator.userAgent,page:location.href,url:r.url,param:i,info:e}),id:o,level:"error"},type:"POST"}),u({url:"/misc/jslog?1=1",data:{content:l.format("[fakeid={uin}] [xhr] [url={url}] [param={param}] [info={info}] [useragent={useragent}] [page={page}]",{uin:p.uin,useragent:window.navigator.userAgent,page:location.href,url:r.url,param:i,info:e}),id:6+(t?100:0),level:"error"},type:"POST"}),"timeout"!==e||r.notShowTimeoutErr||Vue.prototype.$tipsErr("你的网络环境较差，请稍后重试")}function s(e,n){var s=e
return"function"!=typeof s&&(s=function(){}),e=function(e){try{var r=s.toString(),t={uin:p.uin||"0",id:"64430",key:"0",url:"",location:encodeURIComponent(window.location.href)||"",ret:e&&e.base_resp&&e.base_resp.ret||"undefined"}
if(e&&e.base_resp&&0!==e.base_resp.ret&&(r.indexOf("handleRet")<0&&r.indexOf(e.base_resp.ret)<0&&((new Image).src=l.format("https://badjs.weixinbridge.com/badjs?level=4&uin={uin}&id={id}&msg={msg}&from={url}",{uin:t.uin,url:t.url||t.location,id:138,msg:encodeURIComponent("ret="+t.ret+"|idkey="+t.id+":"+t.key)})),void 0!==window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs)){var o=""
if(-1!==n.indexOf("?")){o=n.substr(0,n.indexOf("?"))
var a=c.parseQuery(n)
a.action&&(o+="?action="+a.action)}else o=n
window.WX_BJ_REPORT.BadJs.report(o,"ret="+e.base_resp.ret,{mid:window.PAGE_MID,view:"web_retcode"})}}catch(e){console.error(e)}s(e)}}var i=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]
for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},u=e("pages/modules/utils/ajax.js"),l=e("pages/modules/utils/str_util.js"),d=e("pages/modules/utils/object.js"),c=e("pages/modules/utils/url.js"),p=window.wx.commonData?window.wx.commonData.data:window.wx.data,m={token:p.t,lang:p.lang,f:"json",ajax:"1"},g={0:"恭喜你，操作成功！","-1":"系统错误，请稍后尝试。",200002:"参数错误，请核对参数后重试。",200003:"登录超时，请重新登录。",200004:"请求页面的域名没有授权。",200005:"请求方式错误，请确认请求方式后重试。",200006:"表单名称验证出错，请核对表单名称后重试。",200007:"对不起，你没有权限访问目标请求。",200040:"登录超时，请重新登录。"},o={updateCommonPostData:function(){m={token:p.data.t,lang:p.lang,f:"json",ajax:"1"}},get:function(t,e,o,r){t.data=a(t.data),t.success=t.success||e,t.complete=t.complete||r,o=t.error||o,t.error=function(e,r){n(r,t),o&&o(e,r)},t.dataType="json",t.success=s(t.success,t.url),u(t)},post:function(t,e,o,r){t.type="POST",t.data=a(t.data),t.success=t.success||e,t.complete=t.complete||r,o=t.error||o,t.error=function(e,r){n(r,t),o&&o(e,r)},t.dataType="json",t.success=s(t.success,t.url),u(t)},handleRet:function(e,r){console.log(e,r)
var t={msg:r.msg||"系统繁忙，请稍后尝试"}
if(e&&e.base_resp&&e.base_resp.ret){r=d.clone(r,!0),(r=i({uin:p.uin||"0",id:"64430",key:"0",url:"",location:encodeURIComponent(window.location.href)||"",ret:e.base_resp.ret,showMsg:!0,msg:"系统繁忙，请稍后尝试"},r)).url=encodeURIComponent(r.url)
var o=g[r.ret]
o?(r.showMsg&&Vue.prototype.$tipsErr(o),t.msg=o):((new Image).src=l.format("/mp/unknow_ret_report?uin={uin}&id={id}&key={key}&url={url}&location={location}&ret={ret}&method=get&action=report",r),r.showMsg&&Vue.prototype.$tipsErr(r.msg),(new Image).src=l.format("/mp/unknow_ret_report?uin={uin}&id=64430&key=126&url={url}&location={location}&ret={ret}&method=get&action=report",r),(new Image).src=l.format("https://badjs.weixinbridge.com/badjs?level=4&uin={uin}&id={id}&msg={msg}&from={url}",{uin:r.uin,url:r.url||r.location,id:138,msg:encodeURIComponent("ret="+r.ret+"|idkey="+r.id+":"+r.key)}))}return t}}
t.exports=o})
define("pages/modules/utils/str_util.js",[],function(t,n,e){"use strict"
e.exports={escape2Html:function(t){var e={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'}
return t.replace(/&(lt|gt|nbsp|amp|quot);/gi,function(t,n){return e[n]})},format:function(t,e){return t.replace(/\{(\w+)\}/g,function(t,n){return void 0!==e[n]?e[n]:t})},sprintf:function(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e]
var r=void 0,i=n[0]||"",o=void 0,u=void 0,c=n.length-1
if(c<1)return i
for(r=1;r<1+c;)i=i.replace(/%s/,"{#"+r+"#}"),r++
for(i.replace("%s",""),r=1;void 0!==(o=n[r]);)u=new RegExp("{#"+r+"#}","g"),i=i.replace(u,o),r++
return i},text:function(t){return t.replace(/<\/?[^>]*\/?>/g,"")},len:function(t){return t.replace(/[^\x00-\xff]/g,"**").length},truncate:function(t,n,e){var r=n||30,i=Object.isUndefined(e)?"...":e
return t.length>r?t.slice(0,r-i.length)+i:String(t)},trim:String.prototype.trim||function(t,n){return!0===n?t.replace(/^\s+/,""):!1===n?t.replace(/\s+$/,""):t.replace(/^\s+/,"").replace(/\s+$/,"")},html:function(t,n){var e=void 0
e=!1===n?["&#39;","'","&quot;",'"',"&nbsp;"," ","&gt;",">","&lt;","<","&amp;","&"]:["&","&amp;","<","&lt;",">","&gt;"," ","&nbsp;",'"',"&quot;","'","&#39;"]
for(var r=t,i=0;i<e.length;i+=2)r=r.replace(new RegExp(e[i],"g"),e[1+i])
return r},has:function(t,n){return-1<t.indexOf(n)},startsWith:function(t,n){return 0===t.lastIndexOf(n,0)},endsWith:function(t,n){var e=t.length-n.length
return 0<=e&&t.indexOf(n,e)===e},param:function(t,e,n){if("function"!=typeof t.split)return null
var r=t.split(n||"&"),i={}
return r.each(function(t){var n=t.split("=")
2===n.length&&n[0]&&n[1]&&(!0===e?i[decodeURIComponent(n[0])]=decodeURIComponent(n[1]):i[n[0]]=n[1])}),i},empty:function(t){return""===t},blank:function(t){return/^\s*$/.test(t)},bytes:function(t){for(var n=0,e=void 0,r=0;e=t.charAt(n++);)r+=e.charCodeAt().toString(16).length/2
return r}}})
define("pages/modules/utils/object.js",[],function(n,t,e){"use strict"
var r="[object Array]",i="[object Object]",o=Object.prototype.toString,u=Object.prototype.hasOwnProperty
function c(n,t){return u.call(n,t)}function f(n,t){for(var e in t)c(t,e)&&(n[e]=t[e])
return n}function a(n){return o.call(n)===i}function s(n){return o.call(n)===r}var l=null
l="function"==typeof Number.isFinite?Number.isFinite.bind(Number):"function"==typeof window.isFinite?window.isFinite:function(){return!0}
var b=null
b="function"==typeof Object.assign?Object.assign:function(){for(var n=arguments.length,t=Array(n),e=0;e<n;e++)t[e]=arguments[e]
if(null==t[0])throw new TypeError("Cannot convert undefined or null to object")
for(var r=Object(t[0]),i=1;i<t.length;i++){var o=t[i]
if(null!=o)for(var u in o)c(o,u)&&(r[u]=o[u])}return r},e.exports={assign:b,extend:f,clone:function n(t,e){var r=void 0
if(!0!==e)return f({},t)
if(s(t))for(var i in r=[],t)c(t,i)&&(a(t[i])?r.push(n(t[i],!0)):r.push(t[i]))
else for(var o in r={},t)c(t,o)&&(a(t[o])?r[o]=n(t[o],!0):r[o]=t[o])
return r},isObject:a,isElement:function(n){return!(!this||1!==n.nodeType)},isArray:s,isFunction:function(n){return"function"==typeof n},isString:function(n){return"[object String]"===o.call(n)},isBoolean:function(n){return"[object Boolean]"===o.call(n)},isNumber:function(n){return"[object Number]"===o.call(n)},isDate:function(n){return"[object Date]"===o.call(n)},isUndefined:function(n){return void 0===n},isRepExp:function(n){return"[object RegExp]"===o.call(n)},isFinite:l,param:function(n,t){var e=[]
for(var r in n)c(n,r)&&(!0===t?e.push([encodeURIComponent(r),"=",encodeURIComponent(n[r]),"&"].join("")):e.push([r,"=",n[r],"&"].join("")))
return e.join("").slice(0,-1)},each:function(n,t){if(void 0!==t)for(var e in n)if(c(n,e)&&!1===t(n[e],e))break},hasOwn:c}})
"use strict"
define("pages/modules/mplog/notify.js",[],function(t,e,n){var i={listenData:[],listen:function(t,e){"string"==typeof t&&(t=[t])
for(var n=0;n<t.length;n++)Object.prototype.hasOwnProperty.call(i.listenData,t[n])||(i.listenData[t[n]]=[]),i.listenData[t[n]].push(e)},notify:function(t,e){if(Object.prototype.hasOwnProperty.call(i.listenData,t))for(var n=i.listenData[t],a=0;a<n.length;a++)n[a](t,e)}}
return i})
define("pages/editor/editor_store.js",["vat/vat.js","pages/modules/media_dialog/image_dialog/image_dialog_store.js"],function(e,a,i){"use strict"
var o
function s(e,a,i){return a in e?Object.defineProperty(e,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[a]=i,e}var d=e("vat/vat.js"),t=e("pages/modules/media_dialog/image_dialog/image_dialog_store.js"),r=new d.VatStore({modules:(s(o={},t.moduleName,t),s(o,"editor",{namespaced:!0,modules:{plugins:{namespaced:!0,modules:{}}}}),o)})
i.exports=r})
define("pages/modules/media_dialog/image_dialog/image_dialog_store.js",["pages/modules/media_dialog/image_dialog/mutations.js","pages/modules/utils/cgi.js","pages/modules/utils/url.js"],function(e,t,o){"use strict"
var i,p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]
for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},A=e("pages/modules/media_dialog/image_dialog/mutations.js")
function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t]
return o}return Array.from(e)}var s=e("pages/modules/utils/cgi.js"),d=e("pages/modules/utils/url.js").fullUrl
function U(e,t){for(var o=0,i=e.length;o<i;++o)if(String(e[o].fileId)===String(t))return o
return-1}function c(e,t){var o=-1
return 0<=e.length&&(o=U(e,t.fileId)),-1!==o}var a={moduleName:"imageDialog",namespaced:!0,state:{scene:"cdn",innerStep:1,totalnum:0,maxSelect:1,perpage:12,currentPage:1,waterStatus:0,imgs:[],groups:[],selectedGroup:0,selectedImgs:[],cropImg:{url:""},cropImgInfo:[],cropperInfo:[],showLoading:!1,covertingCount:0,fromUpload:[],addGroupForm:{groupName:""},btnLoading:!1,addGroupLoading:!1,groupIdOfUploading:0,addGroupPopoverShow:!1,showSelectImg:!1},mutations:(n(i={},A.INNER_STEP_MUTATION,function(e,t){e.innerStep=+t}),n(i,A.WATER_STATUS_MUTATION,function(e,t){e.waterStatus=+t}),n(i,A.INIT_IMGS_MUTATION,function(e,t){"[object Array]"===Object.prototype.toString.call(t)&&(e.imgs=t)}),n(i,A.UPDATE_IMGS_MUTATION,function(e,t){var o=t.idx,i=t.item
if(i){var n=[].concat(r(e.imgs))
n[o]=i,e.imgs=n}}),n(i,A.ADD_IMGS_MUTATION,function(e,t){if(t){var o=[].concat(r(e.imgs))
o.unshift(t),e.imgs=o}}),n(i,A.REMOVE_IMGS_MUTATION,function(e,t){var o=[].concat(r(e.imgs))
o.splice(t,1),e.imgs=o}),n(i,A.UPDATE_IMG_URL_MUTATION,function(e,t){var o=t.idx,i=t.url
i&&(e.imgs[o].url=i)}),n(i,A.INIT_GROUPS_MUTATION,function(e,t){"[object Array]"===Object.prototype.toString.call(t)&&(e.groups=t)}),n(i,A.UPDATE_GROUPS_MUTATION,function(e,t){var o=t.idx,i=t.item
e.groups.splice(o,1,i)}),n(i,A.SELECTED_GROUP_MUTATION,function(e,t){e.selectedGroup=t}),n(i,A.SELECTED_IMGS_MUTATION,function(e,t){"[object Array]"===Object.prototype.toString.call(t)&&(e.selectedImgs=t)}),n(i,A.UPDATE_SELECTED_IMGS_MUTATION,function(e,t){var o=t.img,i=t.idx
if(o){var n=[].concat(r(e.selectedImgs))
n[i]=o,e.selectedImgs=n}}),n(i,A.ADD_SELECTED_IMGS_MUTATION,function(e,t){t&&e.selectedImgs.push(t)}),n(i,A.REMOVE_SELECTED_IMGS_MUTATION,function(e,t){e.selectedImgs.splice(t,1)}),n(i,A.UPDATE_SELECTED_IMGS_URL_MUTATION,function(e,t){var o=t.idx,i=t.url
i&&(e.selectedImgs[o].url=i)}),n(i,A.TOTAL_NUM_MUTATION,function(e,t){e.totalnum=+t}),n(i,A.CROP_IMG_MUTATION,function(e,t){e.cropImg=t}),n(i,A.CROP_IMG_INFO_MUTATION,function(e,t){"[object Array]"===Object.prototype.toString.call(t)&&(e.cropImgInfo=t)}),n(i,A.CROPPER_INFO_MUTATION,function(e,t){"[object Array]"===Object.prototype.toString.call(t)&&(e.cropperInfo=t)}),n(i,A.UPDATE_COVERTING_COUNT_MUTATION,function(e,t){e.covertingCount+=+t}),n(i,A.FROM_UPLOAD_MUTATION,function(e,t){t?e.fromUpload.push(t):e.fromUpload=[]}),n(i,A.CURRENT_PAGE_MUTATION,function(e,t){e.currentPage=+t}),i),actions:{resetStateAction:function(e){var t=e.dispatch,o=e.commit
o(A.INNER_STEP_MUTATION,1),o(A.DEFAULT_GROUP_MUTATION,0),o(A.WATER_STATUS_MUTATION,0),o(A.INIT_IMGS_MUTATION,[]),o(A.SELECTED_GROUP_MUTATION,4),o(A.SELECTED_IMGS_MUTATION,[]),o(A.CURRENT_PAGE_MUTATION,1),o(A.TOTAL_NUM_MUTATION,0),o(A.FROM_UPLOAD_MUTATION,null),t("__set_state",{showLoading:!1,btnLoading:!1,addGroupLoading:!1,showSelectImg:!1})},setInnerStepAction:function(e,t){(0,e.commit)(A.INNER_STEP_MUTATION,t)},setSelectedGroupAction:function(e,t){(0,e.commit)(A.SELECTED_GROUP_MUTATION,t)},setSelectedImgsAction:function(e,t){(0,e.commit)(A.SELECTED_IMGS_MUTATION,t)},setTotalNumAction:function(e,t){(0,e.commit)(A.TOTAL_NUM_MUTATION,+t)},setCurrentPageAction:function(e,t){(0,e.commit)(A.CURRENT_PAGE_MUTATION,t)},setCropperInfoAction:function(e,t){(0,e.commit)(A.CROPPER_INFO_MUTATION,t)},setCropImgInfoAction:function(e,t){(0,e.commit)(A.CROP_IMG_INFO_MUTATION,t)},setCropImgAction:function(e,t){(0,e.commit)(A.CROP_IMG_MUTATION,t)},setFromUploadAction:function(e,t){(0,e.commit)(A.FROM_UPLOAD_MUTATION,t)},updateGroups:function(e,t){(0,e.commit)(A.UPDATE_GROUPS_MUTATION,t)},changeCovertingCount:function(e,t){(0,e.commit)(A.UPDATE_COVERTING_COUNT_MUTATION,+t)},replaceImgs:function(e,t){var o=e.commit,i=t.idx,n=t.item,r=t.selected
n.selected=!!r,o(A.UPDATE_IMGS_MUTATION,{idx:i,item:n})},addImgs:function(e,t){var o=e.commit,i=t.item,n=t.selected
i.selected=!!n,o(A.ADD_IMGS_MUTATION,i)},removeImgs:function(e,t){(0,e.commit)(A.REMOVE_IMGS_MUTATION,t)},updateSelectedImg:function(e,t){var o=e.commit,i=t.img,n=t.idx,r=t.selected
i.selected=!!r,o(A.UPDATE_SELECTED_IMGS_MUTATION,{img:i,idx:n})},selectImg:function(e,t){var o=e.state,i=e.dispatch,n=e.commit,r=t.i,c=t.currentImg,a=t.forceSelect
if(!c.error){var s=c.url,_=c.fileId,l=c.format,m=c.status,T=c.name
if(o.showSelectImg){var g=p({},o.selectedImgs[r]),u=U(o.imgs,_)
i("updateSelectedImg",{img:{url:s,name:T,fileId:_,format:l,copyrightStatus:m},idx:r,selected:!g.selected}),0<=u&&i("replaceImgs",{idx:u,item:g,selected:!g.selected})}else{var I=p({},o.imgs[r])
if(a)-1===U(o.selectedImgs,_)&&n(A.ADD_SELECTED_IMGS_MUTATION,{url:s,name:T,fileId:_,format:l,copyrightStatus:m,selected:!0}),i("replaceImgs",{idx:r,item:I,selected:!0})
else if(I.selected){var d=U(o.selectedImgs,_)
0<=d&&n(A.REMOVE_SELECTED_IMGS_MUTATION,d),i("replaceImgs",{idx:r,item:I,selected:!1})}else if(1===o.maxSelect){if(o.selectedImgs[0]){var f=U(o.imgs,o.selectedImgs[0].fileId)
if(0<=f)i("replaceImgs",{idx:f,item:p({},o.imgs[f]),selected:!1})
n(A.REMOVE_SELECTED_IMGS_MUTATION,0)}i("replaceImgs",{idx:r,item:I,selected:!0}),n(A.ADD_SELECTED_IMGS_MUTATION,{url:s,name:T,fileId:_,format:l,copyrightStatus:m,selected:!0})}else if(o.selectedImgs.length<o.maxSelect){-1===U(o.selectedImgs,_)&&n(A.ADD_SELECTED_IMGS_MUTATION,{url:s,name:T,fileId:_,format:l,copyrightStatus:m,selected:!0}),i("replaceImgs",{idx:r,item:I,selected:!0})}}"cdn"===o.scene&&!s&&_&&i("getCdnUrlByFileId",_)}},selectGroup:function(e,t){var o=e.state,i=e.dispatch,n=e.commit
n(A.SELECTED_GROUP_MUTATION,t),n(A.CURRENT_PAGE_MUTATION,1),i("__set_state",{showLoading:!0,showSelectImg:!1}),i("resetSelectedImgs"),i("getImagesByBegin",0).then(function(e){i("setTotalNumById",e.page_info.file_group_list.file_group),i("formatData",e).then(function(){i("__set_state",{showLoading:!1}),o.imgs.forEach(function(e,t){c(o.selectedImgs,e)&&i("selectImg",{i:t,currentImg:e,forceSelect:!0})})}).catch(function(){i("__set_state",{showLoading:!1})})}).catch(function(){console.log("get images error"),i("__set_state",{showLoading:!1})})},setTotalNumById:function(e,t){for(var o=e.state,i=e.commit,n=1<arguments.length&&void 0!==t?t:[],r=0,c=n.length;r<c;r++)if(n[r].id===o.selectedGroup){i(A.TOTAL_NUM_MUTATION,n[r].count)
break}},formatData:function(e,t){var T=e.state,g=e.dispatch,u=e.commit,I=[]
return new Promise(function(n,e){t.page_info||e()
var r=0,c=0,a=0,s=t.page_info.file_item.length,_=T.selectedGroup,l=T.currentPage,m=""
u(A.INIT_GROUPS_MUTATION,t.page_info.file_group_list.file_group),u(A.WATER_STATUS_MUTATION,t.page_info.watermark_status),(!t.page_info.file_item||t.page_info.file_item.length<=0)&&e(),t.page_info.file_item.forEach(function(t,o){var i=t.cdn_url||d("/cgi-bin/getimgdata?mode=small&source=file&fileId="+t.file_id),e=new Image
e.onerror=function(){++r,m=m+i+" ",++a===s&&((new Image).src="/mp/jsmonitor?idkey=28308_9_"+r+";28308_10_"+c+"&lc=1&log0=[errorurl]["+encodeURIComponent(m)+"]"),T.selectedGroup===_&&T.currentPage===l&&(I[o]={seq:t.seq,url:i,name:t.name,fileId:t.file_id,status:t.copyright_status||0,format:t.img_format,selected:!1},a===s&&(g("__set_state",{showLoading:!1}),u(A.INIT_IMGS_MUTATION,I),n()))},e.onload=function(){if(++c,++a===s){var e="/mp/jsmonitor?idkey=28308_9_"+r+";28308_10_"+c
0<r&&(e=e+"&lc=1&log0=[errorurl]["+encodeURIComponent(m)+"]"),(new Image).src=e}T.selectedGroup===_&&T.currentPage===l&&(I[o]={seq:t.seq,url:i,name:t.name,fileId:t.file_id,status:t.copyright_status||0,format:t.img_format,selected:!1},a===s&&(u(A.INIT_IMGS_MUTATION,I),n()))},e.src=i})})},getImagesByBegin:function(e,t){var i=e.state,o=e.commit,n=1<arguments.length&&void 0!==t?t:0,r=i.selectedGroup
o(A.INIT_IMGS_MUTATION,[])
var c=d("/cgi-bin/filepage?action=select")
return new Promise(function(t,o){s.get({url:c,data:{group_id:r,begin:n,count:i.perpage,type:2},mask:!1},function(e){e.base_resp&&0===e.base_resp.ret?(i.selectedGroup!==r&&o(),t(e)):(s.handleRet(e,{url:c}),Vue.prototype.$tipsErr("系统繁忙，请稍后尝试"),o())},function(){Vue.prototype.$tipsErr("系统繁忙，请稍后尝试"),o()})})},getCdnUrlByFileId:function(e,i){var n=e.state,r=e.commit
r(A.UPDATE_COVERTING_COUNT_MUTATION,1),s.post({url:d("/cgi-bin/uploadimg2cdn?action=duplicate"),data:{file_id:i,group_id:n.selectedGroup||1},mask:!1},function(e){var t=U(n.selectedImgs,i),o=U(n.imgs,i)
0===Number(e.errcode)?(0<=t&&r(A.UPDATE_SELECTED_IMGS_URL_MUTATION,{idx:t,url:e.url}),0<=o&&r(A.UPDATE_IMG_URL_MUTATION,{idx:t,url:e.url})):(Vue.prototype.$tipsErr("转存失败"),0<=t&&r(A.REMOVE_SELECTED_IMGS_MUTATION,t),0<=o&&r(A.REMOVE_IMGS_MUTATION,t)),r(A.UPDATE_COVERTING_COUNT_MUTATION,-1)},function(){Vue.prototype.$tipsErr("系统繁忙，请稍后尝试")})},createGroup:function(e){var o=e.state,c=e.dispatch,a=e.commit
c("__set_state",{addGroupLoading:!0}),s.post({url:d("/cgi-bin/filepage"),data:{action:"create_group",name:o.addGroupForm.groupName},mask:!1},function(e){c("__set_state",{addGroupLoading:!1})
var t=Number(e.base_resp.ret)
if(0===t){var r=o.addGroupForm.groupName
c("__set_state",{addGroupForm:{groupName:""},addGroupPopoverShow:!1,showLoading:!0,showSelectImg:!1}),c("resetSelectedImgs"),c("getImagesByBegin",0).then(function(e){c("__set_state",{showLoading:!1})
for(var t=e.page_info,o=!1,i=0;i<t.file_group_list.file_group.length;i++){var n=t.file_group_list.file_group[i]
if(n.name===r){a(A.SELECTED_GROUP_MUTATION,n.id),o=!0
break}}o&&(a(A.INIT_GROUPS_MUTATION,t.file_group_list.file_group),a(A.INIT_IMGS_MUTATION,[]),a(A.TOTAL_NUM_MUTATION,0),a(A.CURRENT_PAGE_MUTATION,1))}).catch(function(){c("__set_state",{showLoading:!1})})}else 15006===t?Vue.prototype.$tipsErr("已经超过100个分组，不能再创建新的分组。"):Vue.prototype.$tipsErr("创建失败，请重试")})},pageChange:function(e,t){var o=e.state,i=e.dispatch,n=e.commit,r=(t.currentPage-1)*o.perpage
n(A.CURRENT_PAGE_MUTATION,t.currentPage),i("__set_state",{showLoading:!0}),i("getImagesByBegin",r).then(function(e){i("formatData",e).then(function(){i("__set_state",{showLoading:!1}),o.imgs.forEach(function(e,t){c(o.selectedImgs,e)&&i("selectImg",{i:t,currentImg:e,forceSelect:!0})})}).catch(function(){i("__set_state",{showLoading:!1})})}).catch(function(){i("__set_state",{showLoading:!1})})},changeViewToSelectedImg:function(e){(0,e.dispatch)("__set_state",{showSelectImg:!0})},changeViewToAllImg:function(e){var t=e.dispatch
t("__set_state",{showSelectImg:!1}),t("resetSelectedImgs")},resetSelectedImgs:function(e){var t=e.state;(0,e.commit)("SELECTED_IMGS_MUTATION",t.selectedImgs.filter(function(e){return e.selected}))}}}
o.exports=a,o.exports.default=a})
define("pages/modules/media_dialog/image_dialog/mutations.js",[],function(T,_,I){"use strict"
Object.defineProperty(_,"__esModule",{value:!0})
_.INNER_STEP_MUTATION="INNER_STEP_MUTATION",_.DEFAULT_GROUP_MUTATION="DEFAULT_GROUP_MUTATION",_.WATER_STATUS_MUTATION="WATER_STATUS_MUTATION",_.INIT_IMGS_MUTATION="INIT_IMGS_MUTATION",_.UPDATE_IMGS_MUTATION="UPDATE_IMGS_MUTATION",_.ADD_IMGS_MUTATION="ADD_IMGS_MUTATION",_.REMOVE_IMGS_MUTATION="REMOVE_IMGS_MUTATION",_.UPDATE_IMG_URL_MUTATION="UPDATE_IMG_URL_MUTATION",_.INIT_GROUPS_MUTATION="INIT_GROUPS_MUTATION",_.UPDATE_GROUPS_MUTATION="UPDATE_GROUPS_MUTATION",_.SELECTED_GROUP_MUTATION="SELECTED_GROUP_MUTATION",_.SELECTED_IMGS_MUTATION="SELECTED_IMGS_MUTATION",_.UPDATE_SELECTED_IMGS_MUTATION="UPDATE_SELECTED_IMGS_MUTATION",_.ADD_SELECTED_IMGS_MUTATION="ADD_SELECTED_IMGS_MUTATION",_.REMOVE_SELECTED_IMGS_MUTATION="REMOVE_SELECTED_IMGS_MUTATION",_.UPDATE_SELECTED_IMGS_URL_MUTATION="UPDATE_SELECTED_IMGS_URL_MUTATION",_.TOTAL_NUM_MUTATION="TOTAL_NUM_MUTATION",_.CROP_IMG_MUTATION="CROP_IMG_MUTATION",_.CROP_IMG_INFO_MUTATION="CROP_IMG_INFO_MUTATION",_.CROPPER_INFO_MUTATION="CROPPER_INFO_MUTATION",_.UPDATE_COVERTING_COUNT_MUTATION="UPDATE_COVERTING_COUNT_MUTATION",_.FROM_UPLOAD_MUTATION="FROM_UPLOAD_MUTATION",_.CURRENT_PAGE_MUTATION="CURRENT_PAGE_MUTATION"})
define("pages/modules/media_dialog/mass_send_dialog/mass_send_dialog.js",["pages/modules/media_dialog/mass_send_dialog/mass_send_dialog.css.js","pages/modules/verify_code/verify_code.js","vue-weui/src/form/form.js","vue-weui/src/input/input.js","vue-weui/src/form/form_item.js","vue-weui/src/dropdown/dropdown.js","vue-weui/src/switch/switch.js","vue-weui/src/time_picker/time_picker.js","vue-weui/src/cascader/cascader.js","pages/modules/region/region.js","vue-weui/src/dropdown_cascade/dropdown_cascade.js","pages/modules/masssend/originalDialog/originalDialog.js","pages/modules/utils/str_util.js","3rd/moment/moment.js","pages/modules/media_dialog/mass_send_dialog/mass_send_dialog.tpl.js","pages/modules/utils/cgi.js","js/message/message_cgi.js","pages/modules/utils/url.js","js/common/wx/media/factory.js","js/common/wx/mpEditor/common/eventbus.js","pages/editor/eventBus4Web1.js","3rd/editor/common/monitor.js","js/safe/safe_check.js","js/tpl/mass/sendqueue_popup.html.js"],function(u,t,i){"use strict"
var e,a=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i]
for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t}
function n(t){return function(){var o=t.apply(this,arguments)
return new Promise(function(r,n){return function i(t,e){try{var a=o[t](e),s=a.value}catch(t){return void n(t)}if(!a.done)return Promise.resolve(s).then(function(t){i("next",t)},function(t){i("throw",t)})
r(s)}("next")})}}function s(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}u("pages/modules/media_dialog/mass_send_dialog/mass_send_dialog.css.js"),u("pages/modules/verify_code/verify_code.js"),u("vue-weui/src/form/form.js"),u("vue-weui/src/input/input.js"),u("vue-weui/src/form/form_item.js"),u("vue-weui/src/dropdown/dropdown.js"),u("vue-weui/src/switch/switch.js"),u("vue-weui/src/time_picker/time_picker.js"),u("vue-weui/src/cascader/cascader.js"),u("pages/modules/region/region.js"),u("vue-weui/src/dropdown_cascade/dropdown_cascade.js"),u("pages/modules/masssend/originalDialog/originalDialog.js")
var y=u("pages/modules/utils/str_util.js"),m=u("3rd/moment/moment.js"),r=u("pages/modules/media_dialog/mass_send_dialog/mass_send_dialog.tpl.js"),o=u("pages/modules/utils/cgi.js"),d=u("js/message/message_cgi.js"),c=u("pages/modules/utils/url.js"),h=u("js/common/wx/media/factory.js"),p=u("js/common/wx/mpEditor/common/eventbus.js"),g=u("pages/editor/eventBus4Web1.js"),l=u("3rd/editor/common/monitor.js"),_=u("js/safe/safe_check.js")
var f=function(t){var i="",e="",a=""
if(void 0===t)return""
for(var s=0,r=t.length;s<r;s++){var n=t[s].func_id,o=t[s].unlock_time,d=t[s].ban_time
"2"==n?e=o?o==d?"永久屏蔽原创功能":"屏蔽原创功能至"+m.unix(o).format("YYYY年MM月DD日 HH:mm"):"":"3"==n&&(a=o?o==d?"永久屏蔽赞赏功能":"屏蔽赞赏功能至"+m.unix(o).format("YYYY年MM月DD日 HH:mm"):"")}return e&&a?i=y.sprintf("经用户举报，你的帐号已%s，已%s，屏蔽期间发出的文章将没有原创及赞赏标识。<br>",e,a):e?i=y.sprintf("经用户举报，你的帐号已%s，因为赞赏仅向原创文章开放，因而屏蔽期间赞赏功能也不可使用。本文发出后将没有原创及赞赏标识。<br>",e):a&&(i=y.sprintf("经用户举报，你的帐号已%s，屏蔽期间发出的文章将没有赞赏标识。<br>",a)),i}(wx.cgiData.forbit)
function b(t,i,e){e.mid="mmbizweb:editor/masssend","warn"===t&&(e.msg&&(i+="["+e.msg+"]"),WX_BJ_REPORT.BadJs.report(t,i,e)),"error"===t&&(e.msg&&(i+="["+e.msg+"]"),WX_BJ_REPORT.BadJs.report(t,i,e))}var w={delay:0,time:0,data:{},timeout:6e4,check:function(i,e,t,a){var s=this,r={first_check:t?1:0,type:i.type,appmsgid:i.appmsgid}
this.data=i,d.checkCopyright(r,function(t){switch(t&&t.base_resp&&void 0!==t.base_resp.ret||(ret=-1),+t.base_resp.ret){case 154008:case 154009:s.done(t,e,a)
break
case 154011:s.polling(i,e,a)
break
case 200013:e.$tipsErr("操作太频繁，请稍后再试"),e.btTxt="群发",e.submitDisabled=!1,b("error","Copyright",{msg:t.base_resp.ret})
break
case 64715:e.innerShow=!1,e.submitDisabled=!1,p.fireEvent("showMassSendOriginalDialog",{list:t&&t.check_copyright_declare_resp_info&&t.check_copyright_declare_resp_info.check_copyright_declare_resp_list||[]})
break
default:e.$tipsErr("系统错误，请稍后重试。"),e.btTxt="群发",e.submitDisabled=!1,b("error","Copyright",{msg:t.base_resp.ret})}},function(t){"mass_send_check_copyright_timeout"!=t&&s.polling(i,e)})},polling:function(t,i,e){var a=this
0===this.delay?this.delay=10:this.delay=500,3010==this.time?(i.innerShow=!1,i.copyRightingShow=!0,i.copyRightingContent="校验预计用时:57秒|文章正在进行原创校验，请勿关闭浏览器，等待校验完成。"):3010<this.time&&this.time<this.timeout?(i.copyRightingContent=y.sprintf("校验预计用时:%s秒|文章正在进行原创校验，请勿关闭浏览器，等待校验完成。",this.timeout/1e3-Math.floor(this.time/1e3)),i.btTxt=y.sprintf("原创校验中(%s)",w.timeout/1e3-Math.floor(w.time/1e3))):this.time>this.timeout&&(i.innerShow=!1,i.btTxt="群发",i.submitDisabled=!1,i.copyRightingShow=!1,i.copyRightedShow=!0),this.time<this.timeout?(setTimeout(function(){a.check(t,i,!1,e)},this.delay),this.time+=this.delay):(this.delay=0,this.time=0,this.data={})},done:function(t,i,e){154009===t.base_resp.ret?(this.data.direct_send=1,e(this.data)):154008===t.base_resp.ret?(i.postData.list=t.list||"",i.originalList=JSON.parse(t.list).list,i._orglist=t.list,i.originalAppmsgid=this.data.appmsgid+"",i.originalDialogShow=!0,i.innerShow=!1,b("warn","Copyright",{msg:t.base_resp.ret,_info:{list:t.list}})):(b("error","Copyright",{msg:t.base_resp.ret}),i.$tipsErr("系统错误，请稍后重试。")),i.submitDisabled=!1,i.btTxt="群发",this.delay=0,this.time=0,this.data={}}},v={withoutADWoring:"",check:function(w,v){var S=this
return b("info","Ad.check",{msg:JSON.stringify(w)}),new Promise(function(f){d.checkSponsorAd({appmsg_id:w.appmsgid},function(t){if(S.withoutADWoring="",0==t.base_resp.ret){for(var i=t.check_ad_resp.ad_info,e=t.check_ad_resp.ad_num,a=t.check_ad_resp.article_aid_num,s=t.check_ad_resp.article_aid_list,r=w.isMulti,n="",o=0;o<s.length;o++)for(var d=0;d<i.length;d++)i[d].idx==s[o].idx&&(i[d].save_aid=s[o].aid)
if(r||0!=e||1!=a)if(r&&0==e&&1==a)n=1==s[0].idx?"今日图文首篇文章暂无广告订单，但含有广告卡片，请删除该广告订单后再群发。":"今日图文第二篇文章暂无广告订单，但含有广告卡片，请删除该广告订单后再群发。",S.warn(n,v)
else if(1==e&&2==a)n=1==i[0].idx?"今日图文第二篇文章暂无广告订单，但含有广告卡片，请删除该广告订单后再群发。":"今日图文首篇文章暂无广告订单，但含有广告卡片，请删除该广告订单后再群发。",S.warn(n,v)
else if(0==e&&2==a)n="今日图文首篇文章暂无广告订单，但含有广告卡片，第二篇文章暂无广告订单，但含有广告卡片，请删除该广告订单后再群发。",S.warn(n,v)
else if(0==e&&0==a)f(w.appmsgid)
else if(1==e)2!=i[0].idx||r?(n="今日图文"+S._getAdWordingHead(r,i[0])+S._getAdWordingBody(i[0])+S._getAdWordingFoot(i[0]),"SponsorAdPreview"==S._getFuncName(i[0])?S.preview(n,i,v):"SponsorAdDefault"==S._getFuncName(i[0])?S.warn(n,v):"checkMusic"==S._getFuncName(i[0])?(S.withoutADWoring=n,f(w.appmsgid)):"SponsorAdOther"==S._getFuncName(i[0])&&S.warn(n,v)):(n=y.sprintf("今日图文第二篇广告主为%s，群发单图文将会导致广告违约，请继续编辑素材。",i[0].ad_buyer_name),S.warn(n,v))
else if(2==e){if(r){var c=S._getAdWordingHead(r,i[0]),u=S._getAdWordingHead(r,i[1]),m=S._getAdWordingBody(i[0]),h=S._getAdWordingBody(i[1]),p=S._getAdWordingFoot(i[0]),g=S._getAdWordingFoot(i[1]),l=S._getFuncName(i[0]),_=S._getFuncName(i[1])
n="今日图文"+c+m+u+h+(""==p||""==g?"":p),"SponsorAdDefault"==l||"SponsorAdDefault"==_||"SponsorAdOther"==l||"SponsorAdOther"==_?S.warn(n,v):"SponsorAdPreview"==l||"SponsorAdPreview"==_?S.preview(n,i,v):(S.withoutADWoring=n,f(w.appmsgid))}else n=y.sprintf("今日图文首篇广告主为%s，第二篇广告主为%s，群发单图文将会导致广告违约，请继续编辑素材。",i[0].ad_buyer_name,i[1].ad_buyer_name),S.warn(n,v)
b("warn","AD",{msg:t.base_resp.ret,_info:{ad_info:i,ad_num:e,article_aid_num:a,article_aid_list:s,isMulti:r,content:n}})}else f(w.appmsgid)
else n="今日图文暂无广告订单，但含有广告卡片，请删除该广告卡片后再群发。",S.warn(n,v)}else b("error","AD",{msg:t.base_resp.ret}),v.$tipsErr("系统错误")},function(t){})})},warn:function(t,i){i.adWarnShow=!0,i.innerShow=!1,i.adWarnContent=t},preview:function(t,i,e){for(var a=0;a<i.length;a++)i[a].video_info&&(i[a].ad_img=i[a].video_info.thumbUrl)
e.adViewShow=!0,e.adViewList=i,e.innerShow=!1,e.adViewContent=t},_getAdWordingHead:function(t,i){var e="广告主为%s，",a="首篇广告主为%s，",s="第二篇广告主为%s，"
return t||1!=i.idx?t&&1==i.idx?y.sprintf(a,i.ad_buyer_name):2==i.idx?y.sprintf(s,i.ad_buyer_name):void 0:y.sprintf(e,i.ad_buyer_name)},_getAdWordingBody:function(t){var i="图文内广告已准备完毕。",e="图文内插入对应广告后尚未发送给广告主预览，请确认后再群发。",a="该广告素材于%s更新，图文内广告已准备完毕。",s="%s提交更新的素材仍在审核中，若直接群发，图文不带广告素材且不会导致违约。",r="图文内尚未插入对应广告，群发图文会导致广告违约，请继续编辑素材。",n="图文内插入对应广告后，须广告主确认才可群发。"
return t.save_aid==t.ad_id&&1==t.status&&(4==t.ad_status&&0==t.trade_mode||6==t.ad_status&&1==t.trade_mode)?i:t.save_aid!=t.ad_id||1!=t.status&&2!=t.status||3!=t.ad_status?t.save_aid==t.ad_id&&2==t.status&&(4==t.ad_status&&0==t.trade_mode||6==t.ad_status&&1==t.trade_mode)?y.sprintf(a,m.unix(t.update_time).format("YYYY-MM-DD")):t.save_aid!=t.ad_id&&t.save_aid||3!=t.status?(t.save_aid||1!=t.status&&2!=t.status)&&t.save_aid==t.ad_id?t.save_aid!=t.ad_id||1!=t.status&&2!=t.status||6==t.ad_status||1!=t.trade_mode?void 0:n:r:y.sprintf(s,m.unix(t.update_time).format("YYYY-MM-DD")):e},_getAdWordingFoot:function(t){var i="消息开始群发后无法撤回，是否群发？"
return(t.save_aid!=t.ad_id||1!=t.status||!(4==t.ad_status&&0==t.trade_mode||6==t.ad_status&&1==t.trade_mode))&&(t.save_aid!=t.ad_id||2!=t.status||!(4==t.ad_status&&0==t.trade_mode||6==t.ad_status&&1==t.trade_mode))&&(t.save_aid!=t.ad_id&&t.save_aid||3!=t.status)?"":i},_getFuncName:function(t){return t.save_aid==t.ad_id&&1==t.status&&(4==t.ad_status&&0==t.trade_mode||6==t.ad_status&&1==t.trade_mode)?"SponsorAdPreview":t.save_aid!=t.ad_id||1!=t.status&&2!=t.status||3!=t.ad_status?t.save_aid==t.ad_id&&2==t.status&&(4==t.ad_status&&0==t.trade_mode||6==t.ad_status&&1==t.trade_mode)?"SponsorAdPreview":t.save_aid!=t.ad_id&&t.save_aid||3!=t.status?(t.save_aid||1!=t.status&&2!=t.status)&&t.save_aid==t.ad_id?t.save_aid!=t.ad_id||1!=t.status&&2!=t.status||6==t.ad_status||1!=t.trade_mode?void 0:"SponsorAdOther":"SponsorAdDefault":"checkMusic":"SponsorAdDefault"}},S={param:{},scan:function(i){_.check(this.param,function(t){i.postData.code=t.code,i.post()},{onShow:function(){i.innerShow=!1},onClose:function(){i.innerShow=!0},checkdom:".js_wxcheck0"})}},D=function(a,s){return b("info","Music.check",{msg:a}),new Promise(function(e){o.post({url:"/cgi-bin/masssend?action=check_music",data:{appmsgid:a},error:function(){e()}},function(t){var i=t&&t.base_resp?t.base_resp.ret:-1
0!=i||t.list&&0!==t.list.length?0==i&&t.list&&0<t.list.length?(s.innerShow=!1,p.fireEvent("showMusicCheckDialog",{focustype:"callback",appmsgid:a,musicdata:t.list}),b("warn","Music",{msg:t.base_resp.ret,_info:{list:t.list}})):(b("error","Music",{msg:t.base_resp.ret}),e()):e()})})},k=(s(e={loading:!1,direct_send:0,isPreviewing:!1,timeConfirmShow:!1,copyRightingShow:!1,copyRightedShow:!1,copyRightingContent:"",needVerifycode:!1,verifyCode:"",sameMaterialStatus:0,safeScan:!0,confirmStauts:0,adViewList:[],adViewContent:"",adViewShow:!1,adWarnContent:"",adWarnShow:!1,nick_name:wx.cgiData.nick_name,originalList:[],originalAppmsgid:"",postData:{},originalDialogShow:!1,_orglist:""},"originalList",[]),s(e,"originalAppmsgid",""),s(e,"btTxt","群发"),s(e,"submitDisabled",!1),s(e,"confirmShow",!1),s(e,"confirmMsg",""),s(e,"group",[-1]),s(e,"areas",{country:{label:"",value:-1}}),s(e,"innerShow",!1),s(e,"timer",!1),s(e,"curTime",""),s(e,"curTime2","00:00"),s(e,"minTime",""),s(e,"sex","0"),s(e,"day","1"),s(e,"sexData",[{label:"全部",value:"0"},{label:"男",value:"1"},{label:"女",value:"2"}]),s(e,"dayData",[{label:"今天",value:"1"},{label:"明天",value:"2"}]),e)
Vue.component("masssend-send-dialog",{template:r,mounted:function(){this.isSendTicket&&(wx.url=function(t){if(t.startsWith("javasript:"))return t
var i=wx.data.param
return-1!=t.indexOf("?")?t+i:t+"?1=1"+i})
var c=this
$(document).on("click",".js_viewqueue",function(){var t,i={type:$(this).data("type"),wx_alias:JSON.parse(c.data.cgiData.strategy_info).wx_alias||"",list:[]}
if("polo"==i.type?(i.count=+c.data.cgiData.auditing_msg_num||0,c.data.cgiData.aduting_msg_json&&(i.list=JSON.parse(c.data.cgiData.aduting_msg_json).list),t="待发送群发消息详情"):"timer"==i.type&&(i.count=+c.data.cgiData.auditing_timer_msg_num||0,c.data.cgiData.auditing_timer_msg_json&&(i.list=JSON.parse(c.data.cgiData.auditing_timer_msg_json).list),t="待确认定时消息详情"),0!=i.count&&0!=i.list.length){for(var e=0,a=i.list.length;e<a;e++)i.list[e].apply_time_desc=m.unix(i.list[e].apply_time).format("YYYY.MM.DD HH:mm")||"",i.list[e].expired_time_desc=m.unix(i.list[e].expired_time).format("YYYY.MM.DD HH:mm")||"",i.list[e].applyer_headimg=i.list[e].applyer_headimg||"http://mmbiz.qpic.cn/mmbiz/a5icZrUmbV8p5jb6RZ8aYfjfS2AVle8URwBt8QIu6XbGewB9wiaWYWkPwq4R7pfdsFibuLkic16UcxDSNYtB8HnC1Q/0"
var s=u("js/tpl/mass/sendqueue_popup.html.js"),r=$(wx.T(s,i)).eq(0).popup({title:t,close:function(){this.remove()},className:"sendqueue_dialog",width:960,buttons:[{text:"知道了",click:function(){this.remove()},type:"primary"}]})
c.innerShow=!1
for(var n=r.find(".js_masscontent"),o=(e=0,i.list.length);e<o;e++)d(i.list[e],e)
r.popup("resetPosition"),r.find(".js_massitem").on("click",function(){var t=$(this),i="selected"
if(t.hasClass(i))return!1
t.siblings(".js_massitem").removeClass(i),t.addClass(i)
var e=$(this).data("index")
n.find(".js_mediaitem").hide(),n.find(".js_media"+e).show(),r.popup("resetPosition")})}function d(t,i){var e=function(t){var i,e=t.detail_info
if(!e)return null
switch(e.type={9:"10",11:"10",16:"15",17:"16",62:"4"}[e.type]||e.type,+e.type){case 10:i={data:e,type:e.type}
break
case 15:if((i=e).multi_item&&0<e.multi_item.length){var a=e.multi_item[0]
for(var s in a)a.hasOwnProperty(s)&&!i[s]&&(i[s]=a[s])}!i.time&&i.create_time&&(i.time=m.unix(i.create_time).format("YYYY年MM月DD日")||"")
break
case 16:(i=card_parser.parse_cardticket(e.card)).type=e.type
break
default:i=e}return i.acl=wx.acl.msg_acl,i}(t),a=h.itemRender[e.type]
if(e&&a){var s=n.find(".js_media"+i)
1!=+e.type&&2!=+e.type&&3!=+e.type||s.addClass("simple_media"),e.hasRecommend=!0,a(s,e)}}}),g.$on("previewClose",function(){c.isPreviewing=!1,c.originalDialogShow=!0})},methods:{cancelConfirm:function(){this.confirmShow=!1,this.innerShow=!0},onPreview:function(){this.isPreviewing=!0},timerSwitchChange:function(t){t?l.setSum(129180,42,1).send():this.hot_time_type=0},groupSwitchChange:function(t){t&&l.setSum(129180,43,1).send()},timerChange:function(t,i){var e=this
o.post({url:"/cgi-bin/masssend?action=check_hot_time",data:{timestamp:Math.floor(i/1e3)}},function(t){t&&t.base_resp&&0==t.base_resp.ret&&0<=t.hot_time_type&&(1==t.hot_time_type?(b("warn","hot_time_type",{msg:t.hot_time_type}),e.hot_time_word="该时刻定时消息过多，你的消息可能延后发送，你可以继续群发或选择其他时刻。",e.hot_time_type=1,e.submitDisabled=!1):2==t.hot_time_type?(b("warn","hot_time_type",{msg:t.hot_time_type}),e.hot_time_word="该时刻定时消息过多，请选择其他时刻。",e.hot_time_type=2,e.submitDisabled=!0):(e.hot_time_word="",e.hot_time_type=0,e.submitDisabled=!1))})},originalDialogShowChange:function(t){this.originalDialogShow=t},originalDialogCancel:function(){this.innerShow=!0},originalDialogSubmit:function(t){var i=this
this.postData.reprint_confirm=1,this.postData.list=this._orglist,this.originalList.each(function(t){i.data.appmsg.multi_item[t.idx-1].isCopyright=!1,i.data.appmsg.multi_item[t.idx-1].isReward=!1}),t&&(this.postData.reprint_info=JSON.stringify({item_list:t})),this.originalDialogShow=!1,b("info","originalDialogSubmit",{msg:JSON.stringify(this.postData)}),v.check(this.postData,this).then(function(t){return D(t,i)}).then(function(){i.checkSafe()})},submit:function(){var t={ack:"",code:"",reprint_info:"",reprint_confirm:0,list:"",groupid:"",sex:this.sex,country:"",province:"",city:"",send_time:0,type:10,share_page:1,synctxweibo:0,operation_seq:this.data.cgiData.operation_seq,req_id:function(t){for(var i="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<t;a++)i+=e.charAt(Math.floor(Math.random()*e.length))
return i}(32),req_time:(new Date).getTime()+1e3*this.data.diff,sync_version:1}
if(this.data.appmsg&&(t=a(t,{appmsgid:this.data.appmsg.app_id,isMulti:this.data.appmsg.isMulti})),this.isSendTicket&&a(t,{type:"16",cardid:this.data.cardData.cardid,cardquantity:this.data.cardData.cardquantity,cardlimit:this.data.cardData.cardlimit}),b("info","submitBegin",{msg:JSON.stringify(t)}),this.hasGroup&&(-1===this.group[0]?t.groupid=-1:"group"===this.group[0]?t.groupid=this.group[1]:"card"===this.group[0]&&(t.groupid=0,t.card_tag_id=this.group[1])),this.areas&&(t.country=this.areas.country.label,"全部"===t.country&&(t.country=""),this.areas.province&&this.areas.province.show&&(t.province=this.areas.province.label,this.areas.city&&this.areas.city.show&&(t.city=this.areas.city.label))),this.timer){var i=m.unix((new Date).getTime()/1e3+this.data.diff).format("YYYY-MM-DD")+" "+("1"===this.day?this.curTime:this.curTime2),e=m(i,"YYYY-MM-DD HH:mm")
"2"===this.day&&e.add(1,"d"),t.send_time=e.unix()}this.needVerifycode&&(t.imgcode=this.verifyCode),this.postData=t,this.data.cgiData.strategy_info?S.param=JSON.parse(this.data.cgiData.strategy_info):S.param=null,this.preCheck(t)},preCheck:function(t){if(b("info","preCheck",{msg:JSON.stringify(t)}),this.confirmStauts=0,wx.cgiData.time_send_total_left=this.data.cgiData.time_send_total_left,0===t.send_time&&wx.cgiData.mass_send_left<=0)this.$tipsErr("剩余群发次数为0")
else if(!(0<t.send_time&&wx.cgiData.time_send_total_left<=0))if(0===t.send_time&&4<=+this.data.cgiData.auditing_msg_num)this.$tipsErr("超过4条群发消息待管理员确认")
else if(0<t.send_time&&4<=+this.data.cgiData.auditing_timer_msg_num)this.$tipsErr("超过4条定时群发消息待管理员确认")
else{if(this.confirmMsg="",0===t.send_time&&0<+this.data.cgiData.auditing_msg_num)return this.confirmShow=!0,this.confirmMsg=y.sprintf('当前有%s条群发消息正在等待管理员审批。<a href="javascript:;" data-type="polo" class="js_viewqueue">查看详情</a><br>是否确认要再次群发消息？',this.data.cgiData.auditing_msg_num),void(this.confirmStauts=1)
if(0!==t.send_time&&0<+this.data.cgiData.auditing_timer_msg_num)return this.confirmShow=!0,this.confirmMsg+=y.sprintf('当前有%s条定时群发消息正在等待管理员审批。<a href="javascript:;" data-type="timer" class="js_viewqueue">查看详情</a><br>是否确认要再次设置定时群发消息？',this.data.cgiData.auditing_timer_msg_num),void(this.confirmStauts=1)
if(!this.needVerifycode||this.verifyCode){if(0<t.send_time){if("1"==this.day&&0==this.data.cgiData.time_send_today_left)return void this.$tipsErr("你今天还能定时群发0次消息")
if("2"==this.day&&0==this.data.cgiData.time_send_tomorrow_left)return void this.$tipsErr("你明天还能定时群发0次消息")
if(0==this.data.time_send_oper_left)return void this.$tipsErr("操作频率过高，请明天再试")}this.check(t)}else this.$tipsErr("请输入验证码")}},doConfirm:function(){var i=this
b("info","doConfirm",{msg:JSON.stringify(this.postData)}),l.setSum(129180,41,1).send(),this.confirmShow=!1,1===this.confirmStauts?this.check(this.postData):2===this.confirmStauts?this.safeScan?S.scan(this):this.post():3!==this.confirmStauts&&4!==this.confirmStauts||(this.confirmShow=!1,this.checkCopyright(this.postData).then(function(t){return v.check(t,i)}).then(function(t){return D(t,i)}).then(function(){i.checkSafe()}))},check:function(s){var r=this
return n(regeneratorRuntime.mark(function t(){var i,e,a
return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r.isSendTicket){t.next=12
break}return t.next=3,r.checkSameMaterial(s)
case 3:return i=t.sent,t.next=6,r.checkCopyright(i)
case 6:return e=t.sent,t.next=9,v.check(e,r)
case 9:return a=t.sent,t.next=12,D(a,r)
case 12:return t.next=14,r.checkSafe()
case 14:case"end":return t.stop()}},t,r)}))()},checkSameMaterial:function(e){var a=this
return b("info","checkSameMaterial",{msg:JSON.stringify(e)}),this.sameMaterialStatus=0,new Promise(function(i,t){o.post({url:"/cgi-bin/masssend?action=check_same_material",data:{msgid:e.appmsgid},error:function(){a.sameMaterialStatus=1,i(e)}},function(t){if(t&&t.base_resp&&67017===t.base_resp.ret)return b("warn","checkSameMaterial",{msg:t.base_resp.ret}),0===a.postData.send_time?(a.sameMaterialStatus=2,a.confirmStauts=3,a.confirmMsg="你已对相同内容设置了群发，建议前往首页定时列表查看，避免重复操作。"):(a.sameMaterialStatus=3,a.confirmStauts=4,a.confirmMsg="你已对相同内容设置了定时消息，建议前往首页定时列表查看，避免重复操作。"),void(a.confirmShow=!0)
a.sameMaterialStatus=1,i(e)})})},checkCopyright:function(e){var a=this
return b("info","checkCopyright",{msg:JSON.stringify(e)}),this.submitDisabled=!0,new Promise(function(t,i){w.check(e,a,!0,t)})},checkSafe:function(){var t=JSON.parse(this.data.cgiData.strategy_info||"{}")
t.third_status=this.data.cgiData.third_status,t.bind_mail=this.data.cgiData.bind_mail,t.timer=this.timer,t.wx_protect&&t.wx_alias?(this.safeScan=!0,t.source="msgs",t.msgid=this.data.cgiData.operation_seq,t.distinguish=!0,S.param=t):this.safeScan=!1,b("info","checkSafe",{msg:JSON.stringify(t)}),this.updateConfirmMsg(),this.confirmStauts=2,this.confirmShow=!0},adSend:function(){this.adViewShow=!1,this.checkSafe()},adCancel:function(){this.adViewShow=!1,this.innerShow=!0},updateConfirmMsg:function(){var i=this,t=""
if("card"===this.group[0]){var e=""
this.groupData[2].options.forEach(function(t){t.value===i.group[1]&&(e=t.label)}),t=y.sprintf("将对%s中已关注公众号的会员群发消息。<br>",-1==this.group[1]?"全部卡券用户":"卡券分组“"+e+"”")}v.withoutADWoring?this.confirmMsg=f+t+v.withoutADWoring:this.confirmMsg=f+t+"消息开始群发后无法撤销"},resetData:function(){for(var t in k)this[t]=k[t]},post:function(){var a=this
b("info","masssend",{msg:JSON.stringify(this.postData)}),d.masssend(this.postData,function(t){a.$tipsSuc("发送成功"),b("info","masssendOk",{msg:JSON.stringify(a.postData)}),window.onbeforeunload=null,location.href=c.fullUrl("/cgi-bin/home?t=home/index")},function(t){if(t&&t.base_resp){var i=t.base_resp.ret
if(b("error","masssend",{msg:i}),"200008"==i)a.$tipsErr("请输入验证码"),a.needVerifycode=!0
else if("67010"==i)a.$tipsErr("该图文消息部分文章正文为空，无法群发，请选择其他文章或编辑完整后再尝试")
else if("1530505"==i)a.$tipsErr("请勿添加其他公众号的主页链接")
else if("1530512"==i)a.$tipsErr("链接已失效，请在手机端重新复制链接")
else if("67019"==i)a.$tipsErr("推荐语不能有违反公众平台协议、相关法律法规和政策的内容，请重新编辑")
else if("13005"==i)a.$tipsErr("今日有待投放赞助广告，你当前群发的内容不符合条件，此时群发将会导致广告违约，请继续编辑。")
else if("153012"==i)a.$tipsErr("文章已声明原创，但未设置转载类型，请设置后再群发。")
else if("64557"==i)a.$tipsErr("卡券无效，请选择其他卡券重试")
else if("230000"==i||"230001"==i||"230003"==i){"230003"==i&&a.$tipsErr("系统繁忙")
var e=""
"230000"==i?e="正在发送中":"230001"==i&&(e=a.postData.send_time?"定时发送成功":"发送成功"),a.confirmShow=!0,a.confirmStauts=3,a.confirmMsg=y.sprintf("操作确认|你5分钟内已操作发送了一条消息，该条消息%s。是否需要再次群发？",e),a.postData.ack=t.ack}else"154008"==i||"154009"==i?w.done(resp,vm):"200043"==i?a.$tipsErr("图文中包含没有关联的小程序，请删除后再群发。"):"200047"==i?a.$tipsErr("标题中不能含有特殊字符"):"67026"==i?(a.confirmShow=!0,a.confirmStauts=2,a.confirmMsg="有视频声明原创失败，群发将不带原创标识，可前往<a href='/cgi-bin/appmsg?begin=0&count=10&action=list_video&type=15' target='_blank'>素材库</a>查看详情。如确认无误，可继续群发",a.postData.video_confirm=1):"67027"==i?(a.confirmShow=!0,a.confirmStauts=2,a.confirmMsg="有视频已被他人先声明原创，将按照转载样式群发，可前往<a href='/cgi-bin/appmsg?begin=0&count=10&action=list_video&type=15' target='_blank'>素材库</a>查看详情。如确认无误，可继续群发",a.postData.video_confirm=1):"67028"==i?a.$tipsErr("视频原创校验失败，无法开启赞赏功能"):t&&t.hasnotHandle&&o.handleRet(t,{id:64462,key:4,url:"/cgi-bin/masssend",msg:"系统繁忙，请稍后尝试",showMsg:!0})
a.confirmShow||a.resetData()}})},areaChange:function(t){this.areas=t},copyRightingClose:function(){this.copyRightingShow||(this.btTxt=y.sprintf("原创校验中(%s)",w.timeout/1e3-Math.floor(w.time/1e3)),this.innerShow=!0)},copyRightedClose:function(){this.copyRightedShow=!1,this.innerShow=!0},copyRightTimeout:function(){var i=this
v.check(this.postData,this).then(function(t){return D(t,i)}).then(function(){i.checkSafe(),i.copyRightedShow=!1})},setPropsData:function(t){this.data=t}},props:{canUsePublicTag:{type:Number,default:0},realnameType:{type:Number,default:0},isShow:{type:Boolean,default:!1},data:{type:Object},isSendTicket:{type:Boolean,default:!1}},watch:{isShow:function(t){this.innerShow=t},adWarnShow:function(t){this.innerShow=!t},innerShow:function(t){1==this.originalDialogShow&&0==this.innerShow||this.$emit("show-change",t)},confirmShow:function(t){t&&(this.innerShow=!t)},isDialogShow:function(t){this.$emit("dialog-change",t)},data:{handler:function(){this.minTime=m.unix(((new Date).getTime()+3e5)/1e3+this.data.diff).format("HH:mm"),this.curTime=this.minTime,console.log(this.data)},immediate:!0}},computed:{isDialogShow:function(){return this.innerShow||this.confirmShow||this.originalDialogShow||this.adWarnShow||this.adViewShow||this.copyRightingShow||this.copyRightedShow},groupData:function(){var t=[{label:"全部标签",value:-1}],i=this.data.cgiData,e=[],a=void 0
if(!i)return t
if(!0===i.has_member_card){t=t.concat([{label:"按用户标签选择",value:"group"},{label:"按卡券会员选择",value:"card"}])
var s=[{label:"全部",value:"-1"}]
i.json_cardtagpage&&(i.card_group_list=JSON.parse(i.json_cardtagpage)),i.card_group_list.datas.forEach(function(t){0===t.type&&s.push({label:t.name,value:t.id})}),t[2].options=s}else t.push({label:"按标签选择",value:"group"})
if(1===i.new_user_tag){i.group=JSON.parse(i.contact_group_list).group_info_list
for(var r=0;r<i.group.length;r++){var n=i.group[r]
2<=n.group_id&&(2===n.group_id?a={label:"星标用户",value:n.group_id}:e.push({label:n.group_name,value:n.group_id}))}e=[a].concat(e.sort(function(t,i){return t.label.localeCompare(i.name)}))}else{i.group=JSON.parse(i.contact_group_list).groups
for(var o=0;o<i.group.length;++o){var d=i.group[o]
e.push({label:d.name,value:d.id})}}return t[1].options=e,t}},data:function(){var t
return s(t={serviceType:wx.cgiData.service_type,innerShow:this.isShow,loading:!1,direct_send:0,video_confirm:0,isPreviewing:!1,hot_time_type:0,hot_time_word:"",timeConfirmShow:!1,copyRightingShow:!1,copyRightedShow:!1,copyRightingContent:"",needVerifycode:!1,verifyCode:"",sameMaterialStatus:0,safeScan:!0,confirmStauts:0,adViewList:[],adViewContent:"",adViewShow:!1,adWarnContent:"",adWarnShow:!1,nick_name:wx.cgiData.nick_name,originalList:[],_orglist:"",originalAppmsgid:"",postData:{},originalDialogShow:!1},"originalList",[]),s(t,"originalAppmsgid",""),s(t,"btTxt","群发"),s(t,"submitDisabled",!1),s(t,"confirmShow",!1),s(t,"confirmMsg",""),s(t,"group",[-1]),s(t,"areas",{country:{label:"",value:-1}}),s(t,"hasGroup",!1),s(t,"timer",!1),s(t,"curTime",""),s(t,"curTime2","00:00"),s(t,"minTime",""),s(t,"sex","0"),s(t,"day","1"),s(t,"sexData",[{label:"全部性别",value:"0"},{label:"男",value:"1"},{label:"女",value:"2"}]),s(t,"dayData",[{label:"今天",value:"1"},{label:"明天",value:"2"}]),t}})})
define("pages/modules/media_dialog/mass_send_dialog/mass_send_dialog.css.js", [], function (require, exports, module){module.exports = "/*How to usefont-family: 'wechatnum';*/.weui-desktop-table {  width: 100%;  border-collapse: collapse;  text-align: left;  /*tr{      &:first-child{        th{          &:first-child{            padding-left: @weuiDesktopTableCellPaddingX;            text-align: left;          }        }      }    } */}.weui-desktop-table th,.weui-desktop-table td {  padding: 18.8px 10px;  word-break: break-all;}.weui-desktop-table th:last-child,.weui-desktop-table td:last-child {  padding-right: 20px;  text-align: right;}.weui-desktop-table th:last-child .weui-desktop-link,.weui-desktop-table td:last-child .weui-desktop-link {  display: inline-block;  vertical-align: middle;  margin-right: 0;  margin-left: 14px;}.weui-desktop-table th:last-child .weui-desktop-link:first-child,.weui-desktop-table td:last-child .weui-desktop-link:first-child {  margin-left: 0;}.weui-desktop-table th:first-child,.weui-desktop-table td:first-child {  padding-left: 20px;  text-align: left;}.weui-desktop-table th {  font-weight: 400;}.weui-desktop-table th.weui-desktop-th__dropdown__wrp {  padding: 0;}.weui-desktop-table td {  border-bottom: 1px solid #E4E8EB;}.weui-desktop-table td:first-child {  padding-left: 20px;  text-align: left;}.weui-desktop-table td[loading=\"true\"],.weui-desktop-table td[empty=\"true\"] {  color: #9A9A9A;  text-align: center;  padding: 65px 0;}.weui-desktop-table__hd {  background-color: #F6F8F9;  color: #9A9A9A;}.weui-desktop-table__opr {  padding-bottom: 20px;  border-bottom: 1px solid #E4E8EB;}th.weui-desktop-table_rank,td.weui-desktop-table_rank {  text-align: right;}td.weui-desktop-table_rank {  padding-right: 24px;}th.weui-desktop-table_rank {  position: relative;  cursor: pointer;  padding-right: 20px;}th.weui-desktop-table_rank:before,th.weui-desktop-table_rank:after {  content: \" \";  position: absolute;  right: 10px;  top: 50%;}th.weui-desktop-table_rank:before {  display: inline-block;  width: 0;  height: 0;  border-width: 4px;  border-style: dashed;  border-color: transparent;  border-top-width: 0;  border-bottom-color: #D7D7D7;  border-bottom-style: solid;  margin-top: -6px;}th.weui-desktop-table_rank:after {  display: inline-block;  width: 0;  height: 0;  border-width: 4px;  border-style: dashed;  border-color: transparent;  border-bottom-width: 0;  border-top-color: #D7D7D7;  border-top-style: solid;  margin-bottom: -6px;}th.weui-desktop-table_rank:hover:before {  border-bottom-color: #BBBBBB;}th.weui-desktop-table_rank:hover:after {  border-top-color: #BBBBBB;}th.weui-desktop-table_rank_up:after {  display: none;}th.weui-desktop-table_rank_down:before {  display: none;}.weui-desktop-table_dropdown {  position: relative;}.weui-desktop-table_dropdown .weui-desktop-form__drop-down-label {  position: absolute;  top: 0;  background-color: transparent;  border-width: 0;  line-height: 57px;}.weui-desktop-table_dropdown .weui-desktop-form__drop-down__dd {  line-height: 2.57142857;}.weui-desktop-table__row_current.weui-desktop-table__row_current > td {  padding: 0;}.weui-desktop-table__row_current td {  border-bottom-width: 0;}.weui-desktop-table__fold-table {  background: #FFFFFF;  box-shadow: 0 1px 20px 0 rgba(0, 0, 0, 0.1);  border-radius: 2px;}.weui-desktop-table__fold-context {  position: relative;}.weui-desktop-table__fold-context:before {  content: \" \";  border-top: 1px solid #E4E8EB;  position: absolute;  top: -18.8px;  left: 0;  right: 0;}.weui-desktop-table_bat th:first-child .weui-desktop-form__check-label,.weui-desktop-table_bat td:first-child .weui-desktop-form__check-label {  visibility: visible;  opacity: 1;}.weui-desktop-table__check-cell {  text-align: left;}.weui-desktop-table__check-cell .weui-desktop-form__check-label {  visibility: hidden;  opacity: 0;  margin-top: -4px;  -webkit-transition: opacity .34s;  transition: opacity .34s;}tr:hover .weui-desktop-table__check-cell .weui-desktop-form__check-label {  visibility: visible;  opacity: 1;}.weui-desktop-table__check-cell.weui-desktop-table__check-cell {  padding-left: 10px;  padding-right: 5px;  width: 1px;}.weui-desktop-table__check-cell + th,.weui-desktop-table__check-cell + td {  padding-left: 0;}.weui-desktop-table__row_checked {  background-color: #F4FBF4;}.weui-desktop-table__row_bat {  background-color: #F6F8F9;}.weui-desktop-table__row_bat td {  border-bottom-width: 0;  padding-left: 36px;}.weui-desktop-table__bat-context {  position: relative;  padding-left: 18px;}.weui-desktop-table__bat-context:before {  content: \" \";  border-top: 1px solid #E4E8EB;  position: absolute;  top: -18.8px;  left: 18px;  right: 0;}.weui-desktop-table_th-split-default th {  border-bottom: 1px solid #E4E8EB;  border-right: 1px solid #E4E8EB;  padding: 10px;}.weui-desktop-table_th-split-default th:last-child {  border-right-width: 0;}.weui-desktop-table_odd_col_primary td:nth-child(odd) {  background-color: #F4FBF4;}.weui-desktop-table_even_col_primary td:nth-child(even) {  background-color: #F4FBF4;}.weui-desktop-table__title {  padding-bottom: 10px;  font-weight: 400;  font-size: 14px;}.weui-desktop-table_show-head .weui-desktop-table__bd {  display: none;}.weui-desktop-table_show-body .weui-desktop-table__hd {  display: none;}.mass-send {  padding: 0 30px 36px;  display: -ms-flexbox;  display: flex;  min-height: 490px;  box-sizing: border-box;  position: relative;}.mass-send .weui-desktop-dropdowncascade-menu {  overflow: hidden;  width: -webkit-fit-content;  width: fit-content;  width: -moz-fit-content;}.mass-send__list {  width: 455px;  padding-right: 40px;  border-right: 1px solid #D9DADC;  -ms-flex-negative: 0;      flex-shrink: 0;  max-height: 480px;  overflow: auto;}.mass-send__list .weui-desktop-table {  width: 100%;  table-layout: fixed;}.mass-send__list th.ta-c,.mass-send__list td.ta-c {  text-align: center;}.mass-send__list th.ta-c:last-child,.mass-send__list td.ta-c:last-child {  text-align: center;}.mass-send__item-title {  overflow: hidden;  text-overflow: ellipsis;  display: -webkit-box;  -webkit-line-clamp: 2;  -webkit-box-orient: vertical;}.mass-send__icon-check {  display: inline-block;  vertical-align: middle;  width: 18px;  height: 13px;  background-size: cover;  background-image: url(\"data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='13' viewBox='0 0 18 13'%3E  %3Cpath fill='%2307C160' fill-rule='evenodd' d='M.696 7.747C.312 7.349.266 6.664.59 6.224l-.204.278a.977.977 0 0 1 1.381-.194L4.98 8.77c.438.335 1.141.316 1.566-.038L16.252.645c.428-.356 1.093-.33 1.482.054l-.442-.436a.976.976 0 0 1-.002 1.398L6.48 12.301a.987.987 0 0 1-1.406-.022L.696 7.747z'/%3E%3C/svg%3E\");}.mass-send__icon-null {  display: inline-block;  vertical-align: middle;  width: 12px;  height: 1px;  background-color: #D9DADC;}.mass-send__tips {  color: #9A9A9A;}.mass-send__form {  padding-left: 40px;}.mass-send__form .weui-desktop-form__label {  margin-right: 25px;}.mass-send_card .mass-send__form {  padding-left: 0;  -ms-flex: 1;      flex: 1;}.mass-send__form .weui-desktop-form__dropdowncascade {  width: 100%;}.mass-send__form .weui-desktop-form__dropdown {  width: 100%;}.mass-send__form .weui-desktop-form__dropdown__dt.weui-desktop-form__dropdown__inner-button {  border-color: #E4E8EB;  padding: 4.5px 36px 4.5px 15px;}.mass-send__timer-wrp {  margin-top: 5px;}.mass-send__timer {  display: -ms-flexbox;  display: flex;  margin-top: 10px;}.mass-send__timer .weui-desktop-picker__time {  margin-left: 5px;}.mass-send__timer .weui-desktop-form__dropdown {  width: 100px;}.mass-send__timer .weui-desktop-form__dropdown__dt.weui-desktop-form__dropdown__inner-button {  min-width: 0;}.mass-send__footer {  position: relative;}.mass-send__footer .weui-desktop-popover {  opacity: 1;  visibility: visible;}.multi-sent__notice {  -ms-transform: translateY(-50%);      transform: translateY(-50%);  position: absolute;  top: 50%;  color: #9A9A9A;}.multi-sent__notice span {  color: #07C160;  margin: 0 5px;}.mass-send__group-setting {  margin: 10px 0;  font-size: 0;}.mass-send__group-setting > div {  font-size: 14px;  margin-bottom: 10px;}.mass-send__confirm {  position: absolute;  left: 0;  right: 0;  top: 0;  bottom: 0;  background-color: #fff;  display: -ms-flexbox;  display: flex;}.mass-send__confirm .weui-desktop-msg {  margin: auto;}.mass-send_card {  width: 420px;  padding: 0 30px 50px;  min-height: 500px;  margin: 50px auto 0;}.mass-send_card .weui-desktop-form__control-group {  margin-bottom: 0;}.mass-send_card .weui-desktop-form__controls {  -ms-flex: 1;      flex: 1;}.mass-send__card-item {  padding: 16px 0;  border-bottom: 1px solid #E4E8EB;}.mass-send__card-item .weui-desktop-switch {  float: right;}.mass-send__card-item .mass-send__group-setting {  margin-bottom: 0;}.mass-send__card-item .mass-send__group-setting > div:last-child {  margin-bottom: 0;}.mass-send__title {  font-size: 18px;  font-weight: normal;  margin-bottom: 30px;  text-align: center;}";});define("pages/modules/verify_code/verify_code.js",["pages/modules/verify_code/verify_code.tpl.js","vue-weui/src/input/input.js","vue-weui/src/form/form.js","vue-weui/src/form/form_item.js","pages/modules/verify_code/verify_code.css.js"],function(e,r,o){"use strict"
var i=e("pages/modules/verify_code/verify_code.tpl.js")
e("vue-weui/src/input/input.js"),e("vue-weui/src/form/form.js"),e("vue-weui/src/form/form_item.js"),e("pages/modules/verify_code/verify_code.css.js")
Vue.component("mp-verify-code",{template:i,name:"mp-verify-code",model:{prop:"code",event:"input"},props:{name:String,code:{type:String,require:!0,default:""},required:{type:Boolean,default:!1}},data:function(){return{internalCode:this.code||"",random:Date.now(),internalStatus:"normal",codeRules:[{required:!0,message:"请输入验证码",trigger:"blur"}]}},watch:{code:function(e){this.internalCode=e},internalCode:function(e){this.$emit("input",e)}},computed:{verifyImg:function(){return"/cgi-bin/verifycode?r="+this.random}},methods:{onClickRefresh:function(){this.random=Date.now()}}})})
