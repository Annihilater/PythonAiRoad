define("pages/modules/media_dialog/image_dialog/image_crop.css.js", [], function (require, exports, module){module.exports = "/*How to usefont-family: 'wechatnum';*/.img_crop_panel {  height: 365px;  overflow-y: auto;}.img_crop_panel .inner_container_box {  border-width: 0;}.img_crop_area {  padding: 15px 25px 0;}.img_crop_area:after {  content: \"\\200B\";  display: block;  height: 0;  clear: both;}.img_crop_area .jcrop-holder {  display: inline-block;  vertical-align: middle;}.img_crop_area .img_crop_origin_area {  float: left;}.img_crop_wrp {  border: 1px solid #E4E8EB;  background-color: #f4f5f9;  display: inline-block;  vertical-align: top;  width: 245px;  height: 245px;  text-align: center;  font-size: 0;}.img_crop_wrp:after {  content: \" \";  display: inline-block;  vertical-align: middle;  width: 0;  height: 100%;  overflow: hidden;}.img_crop_wrp .img_crop_origin {  max-width: 100%;  max-height: 100%;  vertical-align: middle;}.img_crop_wrp .img_crop_img_hidden {  position: absolute;  left: -1000px;}.img_crop_wrp .img_crop_img {  max-width: 245px;  max-height: 226px;}.img_crop_hd {  padding-bottom: 10px;}.img_crop_ft {  padding-top: 20px;  text-align: left;  padding-left: 15px;}.img_crop_ft .weui-desktop-button-group {  margin-top: 10px;}.img_crop_ft .weui-desktop-btn {  position: relative;  background: none;  line-height: 28px;  border-color: #E4E8EB;  border-right: none;  border-left: none;  color: #9A9A9A;}.img_crop_ft .weui-desktop-btn:hover {  cursor: pointer;}.img_crop_ft .weui-desktop-btn:before {  position: absolute;  top: 50%;  margin-top: -7px;  right: 0;  content: ' ';  display: block;  width: 0;  height: 14px;  border-left: 1px solid #E4E8EB;}.img_crop_ft .weui-desktop-btn:first-child {  border-left: 1px solid #E4E8EB;}.img_crop_ft .weui-desktop-btn:last-child {  border-right: 1px solid #E4E8EB;}.img_crop_ft .weui-desktop-btn:last-child:before {  display: none;}.img_crop_ft .weui-desktop-btn.weui-desktop-btn_current {  color: #07C160;}.img_crop_title {  font-weight: 400;  text-align: left;  padding-left: 20px;}.img_crop_preview_area {  float: none;  display: table-cell;  word-break: break-all;  vertical-align: top;  width: auto;  border-left: 1px solid #E7E7EB;  height: 342px;}.img_crop_preview_area:after {  content: \" . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . \";  display: block;  clear: both;  height: 0;  line-height: 0;  visibility: hidden;}.img_crop_edit_area {  float: left;  margin-right: 10px;  width: 280px;  text-align: center;}.img_crop_edit_area .img_crop_wrp {  height: 226px;}.img_crop_preview_item {  margin-bottom: 20px;  padding-left: 20px;}.img_crop_preview_item:after {  content: \"\\200B\";  display: block;  height: 0;  clear: both;}.img_crop_preview_item:hover {  background-color: #F6F8F9;  cursor: pointer;}.img_crop_preview_item.current {  position: relative;}.img_crop_preview_item.current:before {  content: ' ';  display: block;  width: 4px;  height: 100%;  background-color: #07C160;  position: absolute;  top: 0;  left: -1px;}.img_crop_preview_item:last-child {  margin-bottom: 11px;}.img_crop_preview_hd {  float: left;  margin-right: 14px;  background-color: #F6F8F9;  overflow: hidden;}.img_crop_preview_hd img {  width: 100%;}.img_crop_preview_bd {  overflow: auto;}.img_crop_preview_title {  font-weight: 400;}.img_crop_preview_desc {  color: #9A9A9A;}";});define("pages/modules/media_dialog/image_dialog/image_crop.tpl.js",[],function(i,e,t){return'<div class="img_crop_area">    <div class="img_crop_edit_area">    <div class="img_crop_hd">      <h4 class="img_crop_title">剪裁封面</h4>    </div>    <div class="img_crop_wrp" style="background-color:white;">      <i v-if="src && !imgReady" class="weui-desktop-loading"></i>      <template v-if="src">        <span v-for="(item, idx) in ratio" :class="{\'img_crop_img_hidden\': ratioIdx !== idx}">          <img class="img_crop_img" v-show="imgReady" :src="src" @load="imgLoad(idx)" ref="img">        </span>      </template>    </div>    <div class="img_crop_ft">      <p v-if="ratio[ratioIdx] ? ratio[ratioIdx].cropDescription : false" class="img_crop_preview_desc">                {{ ratio[ratioIdx].cropDescription }}      </p>      <div class="weui-desktop-button-group" v-if="!shouldHideRatioTabs">        <button v-for="(item, idx) in ratio" @click="switchIdx(idx)" class="weui-desktop-btn weui-desktop-btn_default" :class="{\'weui-desktop-btn_current\': ratioIdx === idx}">{{ item.ratio | ratioText }}</button>      </div>    </div>  </div>    <div class="img_crop_preview_area">    <div class="img_crop_hd">      <h4 class="img_crop_title">预览封面</h4>    </div>    <ul class="img_crop_preview_list">            <li v-for="(item, idx) in ratioList" :data-ratio="item.ratio" @click="!item.isChildRatio ? switchIdx(idx) : null" :class="{\'current\': ratioIdx === idx, \'img_crop_preview_item\': 1}">        <span style="width: 130px" :style="{\'height\': \'calc(130px / \' + item.ratio + \')\'}" class="img_crop_preview_hd" ref="preview">          <img v-show="imgReady" style="width: 130px" :src="src" ref="previewImg">        </span>        <div class="img_crop_preview_bd">          <strong class="img_crop_preview_title">            {{ item.title }}（{{ item.ratio | ratioText }}）          </strong>          <p v-if="item.desc" class="img_crop_preview_desc">            {{ item.desc }}          </p>        </div>      </li>    </ul>  </div></div>'})
define("pages/modules/media_dialog/image_dialog/image_content.js",["3rd/jquery/jquery.2.1.4.js","pages/modules/media_dialog/image_dialog/image_crop.css.js","pages/modules/media_dialog/image_dialog/image_content.tpl.js"],function(e,t,i){"use strict"
var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]
for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e}
function r(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t]
return i}return Array.from(e)}e("3rd/jquery/jquery.2.1.4.js"),e("pages/modules/media_dialog/image_dialog/image_crop.css.js")
var s=e("pages/modules/media_dialog/image_dialog/image_content.tpl.js")
Vue.component("mp-image-content",{template:s,props:{imgUrls:{type:Array,default:function(){return[]}},maxselect:{type:Number,default:1},selectedImgs:{type:Array,default:function(){return[]}}},data:function(){return{noImgShow:!0,imgInfo:[]}},created:function(){},mounted:function(){this.getContentImg(this.imgUrls)},methods:{getContentImg:function(e){var i=this
e.forEach(function(t){var e=new window.Image
e.onload=function(){this.onload=null
var e=200<=this.width&&200<=this.height
i.imgInfo.push({isRemote:t.isRemote,uid:t.uid,url:t.url,show:e,selected:!1,format:i.getFormat(t.url)}),e&&(i.noImgShow=!e)},e.src=t.url})},selectImg:function(i){var e=n({},this.imgInfo[i]),t=[]
if(e.selected){this.imgInfo[i].selected=!1
var s=function(e,t){for(var i=0,s=e.length;i<s;i++)if(e[i].url===t)return i
return-1}(this.selectedImgs,this.imgInfo[i].url)
t=[].concat(r(this.selectedImgs)),0<=s&&t.splice(s,1),this.$emit("select-change",t)}else 1===this.maxselect?(this.imgInfo=this.imgInfo.map(function(e,t){return e.selected=t===i,e}),e.selected=!0,t.push(e),this.$emit("select-change",t)):this.selectedImgs.length<this.maxselect&&(this.imgInfo[i].selected=!0,t=[].concat(r(this.selectedImgs),[this.imgInfo[i]]),this.$emit("select-change",t))},getFormat:function(e){return e.substring(e.search("wx_fmt=")).split("=")[1]}}})})
define("pages/modules/media_dialog/image_dialog/image_content.tpl.js",[],function(i,s,a){return'<div class="img_crop_panel">  <div class="appmsg_conent_img_container">      <div v-if="!imgInfo || imgInfo.length <= 0 || noImgShow" class="page_msg large simple default">          <div class="inner">              <span class="msg_icon_wrp"><i class="icon_msg info"></i></span>              <div class="msg_content">                  <h4>正文中无可用做封面的图片</h4>                  <p>封面图片必须为正文中使用过的图片，图片尺寸需大于200*200px，请在正文中插入图文后再选择封面图片</p>              </div>          </div>      </div>      <div v-else class="appmsg_content_img_hd">          <p class="appmsg_content_img_desc">请从正文使用过的图片中选择封面<span class="appmsg_content_img_tips">尺寸小于200*200的图片已被自动过滤</span></p>      </div>      <ul class="appmsg_content_img_list">        <li v-for="(info, i) in imgInfo" :class="[\'appmsg_content_img_item\', !!info.isRemote ? \'loading_item\' : \'\', !!info.selected ? \'selected\' : \'\']" @click="selectImg(i)">          <div v-if="info.show">            <span class="appmsg_content_img cover" :data-remoteid="!!info.isRemote&&!!info.uid ? info.uid : \'\'" :style="\'background-image:url(\' + info.url + \');\'"></span>            <div class="card_mask_global apmsg_content_img_mask">                <i class="icon_card_selected_global"></i>            </div>                        <div v-if="!!info.isRemote" class="card_mask_global apmsg_content_loading_mask">              <i class="icon32_loading dark"></i>              <span class="vm_box"></span>            </div>          </div>          <div v-else>          </div>        </li>      </ul>  </div></div>'})
define("pages/modules/media_dialog/image_dialog/image_dialog.tpl.js",[],function(e,i,t){return'<mp-dialog  weui="true"  ref="dialog"  :title="title"  v-model="dialogShow"  :wrap-class="crop ? \'weui-desktop-dialog_img-picker weui-desktop-dialog_img-picker-with-crop\' : \'weui-desktop-dialog_img-picker\'"  @close="close">    <mp-step v-if="crop" :step="innerStep">    <mp-step-item v-if="fromcontent" title="从正文选择封面"></mp-step-item>    <mp-step-item v-else title="选择封面"></mp-step-item>    <mp-step-item title="裁切封面"></mp-step-item>  </mp-step>    <template v-if="fromcontent">    <mp-image-content v-show="innerStep === 1" :img-urls="contentimgUrls" :maxselect="maxselect" :selected-imgs="selectedImgs" @select-change="contentImgChange"></mp-image-content>  </template>    <template v-else>    <div v-show="innerStep === 1" class="weui-desktop-step__panel">      <div class="weui-desktop-img-picker weui-desktop-grid">        <div class="weui-desktop-grid__item weui-desktop-img-category">          <ul class="weui-desktop-menu">            <li v-for="(group, i) in groups" class="weui-desktop-menu__item" @click="selectGroup(group.id)">              <a href="javascript:;" :class="[\'weui-desktop-menu__link\', selectedGroup === group.id ? \'weui-desktop-menu__link_current\' : \'\', (group.id === 0 || group.id === 4) ? \'\' : \'weui-desktop-menu__link-self\']">                <strong class="weui-desktop-img-category__title">{{group.name}}</strong>                <em class="weui-desktop-img-category__size">&#40;{{group.count}}&#41;</em>              </a>            </li>          </ul>          <div class="weui-desktop-img-category__add">            <mp-popover position="up-center" ref="addGroupPopover" :value="addGroupPopoverShow">              <a slot="target" href="javascript:;" @click.prevent="clickAddGroup">新建分组</a>              <div slot="content">                <mp-form ref="addGroupForm" :model="addGroupForm" weui="true" :rules="addGroupFormRules" @submit.native.prevent>                  <mp-form-item prop="groupName">                    <template slot="label">创建分组</template>                    <mp-input name="group_name" v-model="addGroupForm.groupName"  @input="groupNameInput"></mp-input>                  </mp-form-item>                </mp-form>              </div>              <div slot="bar">                <mp-button type="primary" :loading="addGroupLoading" @click="addGroup">确定</mp-button>                <mp-button type="default" @click="cancelAddGroup">取消</mp-button>              </div>            </mp-popover>          </div>        </div>        <div class="weui-desktop-grid__item">          <div class="weui-desktop-img-picker__list__area">            <div class="weui-desktop-global-mod" v-if="selectedGroup === 4">              <template >                <div v-if="!hideRencentUsedTips" class="weui-desktop-msg weui-desktop-msg_mini weui-desktop-msg_temp" style="background:#F1F3F5">                  <div class="weui-desktop-msg__inner">                    <span class="weui-desktop-msg__hd">                      <i class="weui-desktop-icon-info weui-desktop-icon_msg"></i>                    </span>                    <div class="weui-desktop-msg__bd">                      <h4 class="weui-desktop-msg__title" style="padding-right: 2px;">图片素材新增系统分组“最近使用”(上限500张)，原系统分组“文章配图”不再自动添加图片，你可自行删除此分组或移动此分组里的历史图片。</h4>                      <span class="weui-desktop-msg__close-btn" style="top:21px" @click="closeRecentUsedTips">关闭</span>                    </div>                  </div>                </div>              </template>            </div>            <div v-else class="weui-desktop-global-mod  weui-desktop-media-global-bar">              <div  class="weui-desktop-global__extra">                                <mp-upload :key="selectedGroup" simple url="uploadImageLibFile" :maxfilenum="9999" extclass="weui-desktop-upload_global-media" multi :maxsize="10*1024*1024" :query="uploadQuery" :select="uploadSelect" @error="uploadError" @progress="uploadProgress" @complete="uploadComplete" @allcomplete="uploadAllComplete" :preview="null">                  <template slot="tips">                    <span class="weui-desktop-tips weui-desktop-tips_icon-after">                      <template v-if="$slots.uploadTips && $slots.uploadTips.length > 0">                        <slot name="uploadTips"></slot>，                      </template>                      {{waterStatus === 3 ? \'已关闭图片水印\' : \'已开启图片水印\'}}                      <mp-popover wrap-class="img_water" trigger="hover">                        <i class="icon-svg-common-ask" slot="target"></i>                        <div slot="content">                          <p v-if="waterStatus === 3">不添加水印</p>                          <p v-else-if="waterStatus === 2">水印类型：公众号名称</p>                          <p v-else-if="waterStatus === 1">水印类型：微信号</p>                          <p style="color: rgb(151,164,164);">                            <span v-if="waterStatus === 3">已关闭水印，所有上传的图片都不会带有水印。</span>                            <span v-else>已开启水印，所有上传的图片都会带有水印。</span>                            若需修改请前往<a target="_blank" :href="setWaterUrl">公众号设置/功能设置</a>设置图片水印                          </p>                        </div>                      </mp-popover>                    </span>                  </template>                </mp-upload>              </div>            </div>            <div class="weui-desktop-media-list-wrp weui-desktop-img-picker__list__wrp js_img-picker_wrapper" :style="dialogStyle" ref="imgPickerWrapper">              <div v-if="showLoading" class="weui-desktop-media-tips weui-desktop-media-tips_loading">加载中</div>              <div v-else-if="showSelectImg ? selectedImgs.length === 0 : imgs.length === 0" class="weui-desktop-media-tips">暂无数据</div>              <ul v-else class="weui-desktop-img-picker__list">                <template v-if="showSelectImg">                  <li v-for="(img, i) in selectedImgs" v-if="i < perpage" :key="img.fileId" :class="[\'weui-desktop-img-picker__item\', { selected : img.selected }]" @click.stop.prevent="selectImg({i: i, currentImg: img})">                    <template v-if="!img.loading && !img.msg">                      <i role="img" aria-describedby="图片描述" title="图片描述" class="weui-desktop-img-picker__img-thumb" :style="img.url?\'background-image:url(\' + img.url + \');\':\'\'">                        <span v-show="maxSelect > 1" :class="[\'image_dialog__checkbox\', img.selected ? \'selected\' : \'\']"></span>                      </i>                      <strong class="weui-desktop-img-picker__img-title"><i v-if="img.copyright_status === 2" class="icon_original accessed"></i>{{img.name}}</strong>                    </template>                  </li>                </template>                <template v-if="!showSelectImg">                  <li v-for="(img, i) in imgs" v-if="i < perpage" :key="img.fileId" :class="[\'weui-desktop-img-picker__item\', { selected : img.selected, disabled: !img.selected && !canSelect }]" @click.stop.prevent="selectImg({i: i, currentImg: img})">                    <mp-upload-item v-if="img.loading || img.msg" :file="img" @remove="removeImgItem(img, i)"></mp-upload-item>                    <template v-if="!img.loading && !img.msg">                      <i role="img" aria-describedby="图片描述" title="图片描述" class="weui-desktop-img-picker__img-thumb" :style="img.url?\'background-image:url(\' + img.url + \');\':\'\'">                        <span v-show="maxSelect > 1" :class="[\'image_dialog__checkbox\', img.selected ? \'selected\' : \'\']"></span>                      </i>                      <strong class="weui-desktop-img-picker__img-title"><i v-if="img.copyright_status === 2" class="icon_original accessed"></i>{{img.name}}</strong>                    </template>                  </li>                </template>              </ul>            </div>            <mp-pagination v-if="!showSelectImg" :total-num="totalnum" :per-page="perpage" :current="currentPage" @page-change="pageChange"></mp-pagination>          </div>        </div>      </div>    </div>  </template>    <div v-if="crop && innerStep === 2" class="weui-desktop-step__panel">    <mp-image-crop v-if="innerStep === 2" :src="cropImg.url" :ratio="ratio" :crop-info="cropperInfo" :should-hide-ratio-tabs="shouldHideRatioTabs" @change="cropChange">          </mp-image-crop>  </div>  <template slot="footer">    <div v-if="!fromcontent && innerStep === 1 && maxSelect > 1" class="weui-desktop-img-picker__counter">      <span>已选择 <a href="javascript:" @click="changeViewToSelectedImg">{{selectedImgs | getSelectedImgLength}} / {{maxSelect}}  项</a></span>      <span v-if="showSelectImg"><a href="javascript:" @click="changeViewToAllImg">返回全部</a></span>    </div>    <mp-button v-show="innerStep === 1" type="primary" :disabled="disable" :loading="btnLoading" @click="ok">{{ crop ? \'下一步\' : \'确定\' }}</mp-button>    <mp-button v-if="!crop" @click="close">取消</mp-button>    <mp-button v-show="innerStep === 2" @click="prevStep">上一步</mp-button>    <mp-button v-show="innerStep === 2" type="primary" @click="ok">完成</mp-button>  </template></mp-dialog>'})
define("pages/modules/media_dialog/link_dialog/linkDialog4Web1.js",["pages/modules/media_dialog/link_dialog/link_dialog.js"],function(i,n,e){"use strict"
function l(){return{title:"编辑超链接",isShow:!1,defaultShow:!1,linkinfo:null,type:["innerlink","outerlink"],nickname:window.wx.commonData.data.nick_name,linkUrl:""}}e.exports={getParams:l,bindEvent:function(n){n.eventBus.$on("requireLinkDialog",function(){n.isRequired||(i("pages/modules/media_dialog/link_dialog/link_dialog.js"),n.isRequired=!0)}),n.eventBus.$on("showLinkDialog",function(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}
n.eventBus.$emit("requireLinkDialog"),function(i,n){var e=l()
for(var a in n)void 0!==e[a]&&(e[a]=n[a])
for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(i.params[o]=e[o])
i.params.isShow=!0,i.params.defaultShow=!0}(n,i),n.eventBus.$emit("update-component",{key:"mp-link-dialog",params:n.params})})},close:function(i){i.eventBus.$emit("showLinkDialog_callback",i.data)}}})
define("pages/modules/media_dialog/link_dialog/link_dialog.js",["vue-weui/src/dialog/dialog.js","vue-weui/src/tab/tab.js","pages/modules/media_dialog/link_dialog/link_dialog.css.js","pages/modules/media_dialog/link_dialog/inner_link.js","pages/modules/media_dialog/link_dialog/outer_link.js","pages/modules/media_dialog/link_dialog/link_dialog.tpl.js","pages/modules/utils/object.js"],function(i,e,t){"use strict"
i("vue-weui/src/dialog/dialog.js"),i("vue-weui/src/tab/tab.js"),i("pages/modules/media_dialog/link_dialog/link_dialog.css.js"),i("pages/modules/media_dialog/link_dialog/inner_link.js"),i("pages/modules/media_dialog/link_dialog/outer_link.js")
var l=i("pages/modules/media_dialog/link_dialog/link_dialog.tpl.js"),n=i("pages/modules/utils/object.js").assign,a="innerlink"
Vue.component("mp-link-dialog",{template:l,props:{title:{type:String,default:"添加链接"},value:{type:Boolean,default:!1},linkinfo:{type:Object,default:null},type:{type:Array,default:function(){return[a,"outerlink"]}},nickname:{type:String,default:""},linkUrl:String},data:function(){var i={type:a,title:""}
this.linkinfo&&(i=n(i,this.linkinfo))
var e=!!this.linkinfo,t={innerlink:"公众号文章链接",outerlink:"外部链接"}
return{tabs:this.type.map(function(i){return{id:i,name:t[i]}}),selectedTab:this.linkinfo&&this.linkinfo.type?this.linkinfo.type:a,isEdit:e,dialogShow:!1,searchResult:i}},watch:{value:function(i){!0===i?this.show():this.hide()},dialogShow:function(i){this.$emit("input",i)}},mounted:function(){!0===this.value&&this.show()},methods:{show:function(){!0!==this.dialogShow&&(this.dialogShow=!0)},hide:function(){!1!==this.dialogShow&&(this.dialogShow=!1)},onDialogClose:function(){this.hide(),this.$emit("cancel")},onDialogOK:function(){var e=this
this.selectedTab===a?this.$refs.innerLink.getData().then(function(i){i.tab=e.selectedTab,e.$emit("select",i),e.hide()}):"outerlink"===this.selectedTab&&this.$refs.outerLink.getData().then(function(i){i.tab=e.selectedTab,e.$emit("select",i),e.hide()})},dialogCallback:function(){this.$emit("select",this.searchResult),this.hide()},changeTab:function(i){this.selectedTab=i}}})})
define("pages/modules/media_dialog/link_dialog/link_dialog.css.js", [], function (require, exports, module){module.exports = "/*How to usefont-family: 'wechatnum';*/.weui-desktop-search__wrp {  display: block;  width: auto;}.weui-desktop-search__panel {  background: #FFFFFF;  box-shadow: 0 1px 20px 0 rgba(0, 0, 0, 0.1);  border-radius: 2px;  overflow: auto;  max-height: 200px;}.weui-desktop-search__loadmore {  padding: 20px;  text-align: center;}.weui-desktop-search__loadmore .weui-desktop-loading {  width: 32px;  height: 32px;}.weui-desktop-link-dialog .weui-desktop-media__list-wrp + .weui-desktop-pagination {  padding-bottom: 0;}.link_dialog_panel {  padding: 40px 40px 0;  height: 454px;  overflow-y: auto;  box-sizing: border-box;}.link_dialog_panel .weui-desktop-form__label {  width: 4.1em;}.link_dialog_panel .weui-desktop-form__control-group:last-child {  margin-bottom: 0;}.inner_link_account_item {  padding: 12px;  cursor: pointer;  color: #9A9A9A;}.inner_link_account_avatar {  width: 36px;  height: 36px;  vertical-align: middle;  -webkit-border-radius: 50px;  border-radius: 50px;}.inner_link_account_nickname {  font-weight: 400;  margin-left: 1em;  display: inline-block;  color: #353535;  vertical-align: middle;  max-width: 8em;  width: auto;  overflow: hidden;  text-overflow: ellipsis;  white-space: nowrap;  word-wrap: normal;}.inner_link_account_wechat {  font-style: normal;  margin-left: 1em;  display: inline-block;  vertical-align: middle;  max-width: 12em;  width: auto;  overflow: hidden;  text-overflow: ellipsis;  white-space: nowrap;  word-wrap: normal;}.inner_link_account_msg .weui-desktop-link-btn {  vertical-align: baseline;  margin-left: 1em;}.inner_link_article_area .weui-desktop-media__list-wrp {  max-height: none;  margin-top: 10px;}.inner_link_article_area .weui-desktop-media-tips {  padding: 20px;  box-sizing: border-box;}.inner_link_article_item {  display: block;  border-bottom: 1px solid #E4E8EB;  padding: 10px;  cursor: pointer;  transition: background .3s;}.inner_link_article_item .weui-desktop-form__check-label {  margin-top: -4px;}.inner_link_article_item .weui-desktop-vm_default:first-child {  vertical-align: top;}.inner_link_article_item .weui-desktop-vm_default:last-child {  vertical-align: bottom;  opacity: 0;  visibility: hidden;  -webkit-transition: opacity .3s;  transition: opacity .3s;}.inner_link_article_item:hover {  background-color: #F6F8F9;}.inner_link_article_item:hover .weui-desktop-vm_default:last-child {  opacity: 1;  visibility: visible;}.inner_link_article_item:last-child {  border-bottom: none;}.inner_link_article_title {  font-weight: 400;  overflow: hidden;  text-overflow: ellipsis;  display: -webkit-box;  -webkit-box-orient: vertical;  -webkit-line-clamp: 1;  color: #353535;}.inner_link_article_title em {  font-style: normal;  color: #07C160;}.inner_link_article_date {  color: #9A9A9A;}";});define("pages/modules/media_dialog/link_dialog/inner_link.js",["vue-weui/src/form/form.js","vue-weui/src/form/form_item.js","vue-weui/src/input/input.js","vue-weui/src/button/button.js","vue-weui/src/popover/popover.js","vue-weui/src/radio/radio.js","vue-weui/src/radio/radio_group.js","vue-weui/src/search/search.js","pages/modules/media_dialog/link_dialog/inner_link.tpl.js","pages/modules/utils/cgi.js","pages/modules/utils/string.js","pages/modules/utils/time.js"],function(e,i,t){"use strict"
var s=function(e,i){if(Array.isArray(e))return e
if(Symbol.iterator in Object(e))return function(e,i){var t=[],s=!0,r=!1,a=void 0
try{for(var n,h=e[Symbol.iterator]();!(s=(n=h.next()).done)&&(t.push(n.value),!i||t.length!==i);s=!0);}catch(e){r=!0,a=e}finally{try{!s&&h.return&&h.return()}finally{if(r)throw a}}return t}(e,i)
throw new TypeError("Invalid attempt to destructure non-iterable instance")}
e("vue-weui/src/form/form.js"),e("vue-weui/src/form/form_item.js"),e("vue-weui/src/input/input.js"),e("vue-weui/src/button/button.js"),e("vue-weui/src/popover/popover.js"),e("vue-weui/src/radio/radio.js"),e("vue-weui/src/radio/radio_group.js"),e("vue-weui/src/search/search.js")
var r=e("pages/modules/media_dialog/link_dialog/inner_link.tpl.js"),a=e("pages/modules/utils/cgi.js"),n=e("pages/modules/utils/string.js"),h=e("pages/modules/utils/time.js").formatDate
function c(s){return function(e){for(var i=s,t=0;t<e.length;t++)i=(i<<5)+i+e.charCodeAt(t),i&=2147483647
return i}}var o=c(5200),l=c(5210)
Vue.component("mp-inner-link",{template:r,props:{nickname:{type:String,default:""},linkTitle:{type:String,default:""},linkUrl:String},data:function(){return{linkTitleRule:{required:!0,message:"请输入链接标题",trigger:"none"},linkUrlRule:[{validator:function(e,i,t){return i?/http(s)?:\/\/mp\.weixin\.qq\.com\/(s\?|s\/|mp\/appmsg\/show\?)/.test(i)||/http(s)?:\/\/mp\.weixin\.qq\.com\/mp\/qa\?/.test(i)||/http(s)?:\/\/mp\.weixin\.qq\.com\/mp\/homepage\?/.test(i)||/http(s)?:\/\/mp\.weixin\.qq\.com\/mp\/appmsgalbum\?/.test(i)?/^https?\:\/\/mp\.weixin\.qq\.com\/.*[\?&]tempkey=/.test(i)?t(new Error("不支持插入公众号文章的预览链接，请输入正式链接")):t():t(new Error("请输入公众号相关链接，并以http://或https://开头")):t(new Error("链接地址不能为空，请输入以http://或https://开头的地址"))},trigger:"none"}],innerLinkRules:{},innerLinkModel:{linkTitle:this.linkTitle,type:"search",linkUrl:this.linkUrl||""},innerLinkPlaceholder:"如不填写会默认填入选取文章的标题",defaultBizAvatar:"https://mmbiz.qpic.cn/mmbiz/icTdbqWNOwNRna42FI242Lcia07jQodd2FJGIYQfG0LAJGFxM4FbnQP6yfMxBgJ0F3YRqJCJ1aPAK2dQagdusBZg/0?wx_fmt=png",disabledInput:0<this.linkTitle.length,chooseMsgAid:null,chooseMsgData:null,bizSearchNameFakeId:"",bizSearchName:this.nickname,bizSearchCountPerPage:5,bizSearchLoading:!0,bizSearchResult:[],bizSearchCurrentPage:1,bizSearchStatus:"normal",selectSearchBiz:!0,showBizSearchResult:!1,msgSearchName:"",msgSearchCountPerPage:5,msgSearchTotal:0,msgSearchLoading:!1,msgSearchResult:[],msgSearchCurrentPage:1,showMsgSearchResult:!1,showOprIdx:null,searchingBiz:!1,timeLimit:0,searchLoadingData:!1,canBizSearch:!0}},watch:{},mounted:function(){this.searchMsg()},methods:{searchBiz:function(){1e3<Date.now()-this.timeLimit&&this.bizSearchName.length&&(this.msgSearchName="",this.timeLimit=Date.now(),this.showBizSearchResult=!0,this.canBizSearch=!0,this.bizSearchResult=[],this.bizPageChange({currentPage:1}))},bizPageChange:function(e){var t=this,i=e.currentPage
this.canBizSearch&&(this.bizSearchLoading=!0,this.searchLoadingData=!0,this.bizSearchCurrentPage=i,a.get({url:"/cgi-bin/searchbiz?action=search_biz&begin="+(i-1)*this.bizSearchCountPerPage+"&count="+this.bizSearchCountPerPage+"&query="+encodeURIComponent(this.bizSearchName)},function(e){if(t.searchLoadingData=!1,e&&e.base_resp&&0===e.base_resp.ret){var i=e.total
t.bizSearchResult=t.bizSearchResult.concat(e.list),0===i&&(t.bizSearchLoading=!1,t.canBizSearch=!1),0===t.bizSearchResult.length&&(t.showBizSearchResult=!1,t.bizSearchStatus="warn"),i<=5&&(t.bizSearchLoading=!1)}else t.$tipsErr("系统错误，请稍后重试")}))},searchMsg:function(){this.chooseMsgData=null,this.chooseMsgAid=null,this.showMsgSearchResult=!0,this.msgPageChange({currentPage:1})},msgPageChange:function(e){var i=this,t=e.currentPage
this.msgSearchLoading=!0,this.msgSearchCurrentPage=t,a.get({url:"/cgi-bin/appmsg?action=list_ex&begin="+(t-1)*this.msgSearchCountPerPage+"&count="+this.msgSearchCountPerPage+"&fakeid="+this.bizSearchNameFakeId+"&type=9&query="+encodeURIComponent(this.msgSearchName)},function(e){i.msgSearchLoading=!1,e&&e.base_resp&&0===e.base_resp.ret?(i.msgSearchTotal=e.app_msg_cnt,i.msgSearchResult=e.app_msg_list.map(function(e){var i=o(e.title),t=l(e.title)
return e.title=e.title.replace(/<a[^>]*?>(.*?)<\/a>/gi,function(e,i){return i}).replace(/<em>/gi,i).replace(/<\/em>/gi,t).replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(new RegExp(i,"ig"),"<em>").replace(new RegExp(t,"ig"),"</em>"),e})):i.$tipsErr("系统错误，请稍后重试")})},clearBizSearch:function(){this.showBizSearchResult=!1,this.bizSearchName="",this.canBizSearch=!0,this.bizSearchLoading=!1,this.searchLoadingData=!1,this.bizSearchResult=[],this.bizSearchCurrentPage=1},clearMsgSearch:function(){this.showMsgSearchResult=!1,this.msgSearchName="",this.msgSearchTotal=0,this.msgSearchLoading=!1,this.msgSearchResult=[],this.msgSearchCurrentPage=1,this.chooseMsgAid=null,this.searchMsg()},chooseBiz:function(e){this.bizSearchName=this.bizSearchResult[e].nickname,this.bizSearchNameFakeId=this.bizSearchResult[e].fakeid,this.showBizSearchResult=!1,this.searchingBiz=!1,this.searchMsg()},chooseMsg:function(e,i){s(i,1)[0]&&(this.chooseMsgData=this.msgSearchResult[e],console.log(this.chooseMsgData))},showMsgOpr:function(e){this.showOprIdx=e},hideMsgOpr:function(){this.showOprIdx=null},gotoSearchBiz:function(){this.bizSearchName="",this.searchingBiz=!0,this.chooseMsgData=null},onBizSearchScroll:function(e){var i=e.target
i.scrollTop+i.clientHeight+70>i.scrollHeight&&!this.searchLoadingData&&this.bizPageChange({currentPage:this.bizSearchCurrentPage+1})},getData:function(){var s=this
return new Promise(function(t){s.$refs.innerLinkForm.validate(function(e){if(e){if("search"===s.innerLinkModel.type&&!s.chooseMsgData)return s.$tipsErr("请选择公众号文章"),!1
var i={target:"_blank",href:"",textValue:s.innerLinkModel.linkTitle}
"url"===s.innerLinkModel.type?i.href=s.innerLinkModel.linkUrl:"search"===s.innerLinkModel.type&&(i.href=s.chooseMsgData.link,i["data-itemshowtype"]=s.chooseMsgData.item_show_type,i.textValue.length||(i.textValue=s.chooseMsgData.title.replace(/<\/?em[^>]*?>/gi,""),20<n.htmlDecode(i.textValue).length&&10==+s.chooseMsgData.item_show_type&&(i.textValue=n.htmlEncode(n.htmlDecode(i.textValue).substr(0,20))+"..."))),t(i)}return!1})})},searchInput:function(e){this.bizSearchStatus="normal",0===e.length&&(this.showBizSearchResult=!1,this.bizSearchResult=[])},msgSearchInput:function(e){0===e.length&&(this.showMsgSearchResult=!1,this.msgSearchName="",this.msgSearchTotal=0,this.msgSearchLoading=!1,this.msgSearchResult=[],this.msgSearchCurrentPage=1,this.chooseMsgAid=null,this.searchMsg())},innerLinkTypeChange:function(e){var i=this
"url"===e?(this.innerLinkRules={linkTitle:this.linkTitleRule,linkUrl:this.linkUrlRule},this.innerLinkPlaceholder="请输入链接标题"):"search"===e&&(this.innerLinkRules={},this.innerLinkPlaceholder="如不填写会默认填入选取文章的标题",window.setTimeout(function(){i.$refs.innerLinkForm.validate()},0))}},filters:{formatDate:function(e){return h(e,"YYYY-MM-DD")}}})})
define("pages/modules/media_dialog/link_dialog/inner_link.tpl.js",[],function(e,i,a){return'<mp-form  ref="innerLinkForm"  :rules="innerLinkRules"  :model="innerLinkModel"  :validate-on-rule-change="false"  @submit.native.prevent="test">  <mp-form-item prop="linkTitle">    <template slot="label">链接标题</template>    <template>      <mp-input        ref="linkInput"        filter="trim"        v-model.trim="innerLinkModel.linkTitle"        :placeholder="innerLinkPlaceholder"        :disabled="disabledInput">      </mp-input>    </template>  </mp-form-item>  <mp-form-item class="weui-desktop-form__control-group_offset" prop="type">    <template slot="label">链接内容</template>    <mp-radio-group v-model="innerLinkModel.type" @change="innerLinkTypeChange">      <mp-radio value="search">公众号文章</mp-radio>      <mp-radio value="url">输入链接</mp-radio>    </mp-radio-group>  </mp-form-item>    <template v-if="innerLinkModel.type === \'search\'">    <mp-form-item>      <template slot="label">公众号</template>      <div class="inner_link_account_area">                <template v-if="searchingBiz">          <div class="weui-desktop-search__wrp">            <mp-search              :clear="true"              filter="trim"              placeholder="输入文章来源的公众号名称或微信号，回车进行搜索"              v-model.trim="bizSearchName"              @input="searchInput"              @search="searchBiz"              @clear="clearBizSearch"              :status="bizSearchStatus">              <template slot="message" v-if="bizSearchStatus === \'warn\'">该公众号不存在</template>            </mp-search>            <div              class="weui-desktop-search__panel"              v-if="showBizSearchResult"              @scroll="onBizSearchScroll">                            <ul v-if="bizSearchResult.length > 0" class="inner_link_account_list">                <li                  class="inner_link_account_item"                  v-for="(biz, bizIdx) in bizSearchResult"                  :key="bizIdx"                  @click="chooseBiz(bizIdx)">                  <div class="weui-desktop-vm_primary">                    <img class="inner_link_account_avatar" :src="biz.round_head_img || defaultBizAvatar">                    <strong class="inner_link_account_nickname">{{ biz.nickname }}</strong>                    <i class="inner_link_account_wechat">微信号：{{ biz.alias || \'未设置\' }}</i>                  </div>                  <div class="weui-desktop-vm_default inner_link_account_type">{{ (biz.service_type === 0 || biz.service_type === 1) ? \'订阅号\' : \'服务号\' }}</div>                </li>              </ul>              <div v-if="bizSearchLoading" class="weui-desktop-search__loadmore">                <i class="weui-desktop-loading"></i>              </div>                          </div>          </div>        </template>                <template v-if="!searchingBiz">          <p class="inner_link_account_msg">            {{ bizSearchName }}<mp-button class="weui-desktop-link-btn weui-desktop-link" @click="gotoSearchBiz">选择其他公众号</mp-button>          </p>        </template>      </div>    </mp-form-item>    <mp-form-item v-if="!searchingBiz">      <template slot="label">选择文章</template>      <div class="inner_link_article_area">        <mp-search          :clear="true"          filter="trim"          placeholder="输入文章名查找公众号群发过的文章"          v-model.trim="msgSearchName"          @input="msgSearchInput"          @search="searchMsg"          @clear="clearMsgSearch"></mp-search>        <div v-if="showMsgSearchResult" class="weui-desktop-media__list-wrp">          <div v-if="msgSearchLoading" class="weui-desktop-media-tips"><i class="weui-desktop-loading"></i></div>          <div v-else-if="msgSearchResult.length" class="inner_link_article_list" @mouseleave="hideMsgOpr">            <mp-radio-group v-model="chooseMsgAid">              <label                class="inner_link_article_item"                v-for="(article, articleIdx) in msgSearchResult"                :key="articleIdx"                @mouseenter="showMsgOpr(articleIdx)">                <span class="weui-desktop-vm_default">                  <mp-radio :value="article.aid" @change="chooseMsg(articleIdx, arguments)">                  </mp-radio>                </span>                <div class="weui-desktop-vm_primary">                  <div class="inner_link_article_title">                                        <span></span>                    <div class="weui-desktop-key-tag weui-desktop-key-tag_pay" v-if="article.is_pay_subscribe == 1">付费</div>                    <span v-html="article.title"></span>                  </div>                  <div class="inner_link_article_date">{{ article.update_time | formatDate }}</div>                </div>                                <span class="weui-desktop-vm_default">                  <a :href="article.link" target="_blank">查看文章</a>                </span>              </label>            </mp-radio-group>          </div>          <div v-else class="weui-desktop-media-tips weui-desktop-tips">暂无数据</div>        </div>        <mp-pagination          v-if="!msgSearchLoading"          :total-num="msgSearchTotal"          :per-page="msgSearchCountPerPage"          :current="msgSearchCurrentPage"          @page-change="msgPageChange"></mp-pagination>      </div>    </mp-form-item>  </template>    <template v-if="innerLinkModel.type === \'url\'">    <mp-form-item prop="linkUrl" key="linkUrl">      <template slot="label">文章链接</template>      <template>        <mp-input          filter="trim"          v-model.trim="innerLinkModel.linkUrl"          placeholder="请输入http://或https://开头的公众号文章链接">                  </mp-input>      </template>    </mp-form-item>  </template></mp-form>'})
define("pages/modules/utils/string.js",[],function(t,n,e){"use strict"
function i(t,n){var e=void 0
e=!1===n?["&#39;","'","&quot;",'"',"&nbsp;"," ","&gt;",">","&lt;","<","&amp;","&"]:["&","&amp;","<","&lt;",">","&gt;"," ","&nbsp;",'"',"&quot;","'","&#39;"]
for(var i=t,r=0;r<e.length;r+=2)i=i.replace(new RegExp(e[r],"g"),e[1+r])
return i}e.exports={https2http:function(t){return t.replace(/https:\/\/mmbiz\.qlogo\.cn\//g,"http://mmbiz.qpic.cn/")},http2https:function(t){return t.replace(/http:\/\/mmbiz\.qpic\.cn\//g,"https://mmbiz.qlogo.cn/")},nogif:function(t){return-1<t.indexOf("wx_fmt=gif")||-1<t.indexOf("/mmbiz_gif/")?t.replace("/0?","/s640?").replace("wx_fmt=gif",""):t.toString()},htmlEncode:function(t){return i(t,!0)},htmlDecode:function(t){return i(t,!1)},capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}}})
define("pages/modules/media_dialog/link_dialog/outer_link.js",["pages/modules/media_dialog/link_dialog/outer_link.tpl.js"],function(F,u,t){"use strict"
var e=F("pages/modules/media_dialog/link_dialog/outer_link.tpl.js")
Vue.component("mp-outer-link",{template:e,props:{linkTitle:String,linkUrl:String},data:function(){return{disabledTitleInput:!!this.linkTitle.length,outerLinkModel:{linkTitle:this.linkTitle,linkUrl:this.linkUrl},outerLinkRules:{linkTitle:{required:!0,message:"请输入链接标题",trigger:"none"},linkUrl:[{validator:function(F,u,t){return u?/^https?:\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(u)?t():t(new Error("请输入有效的链接(必须以http://或https://开头)")):t(new Error("链接地址不能为空，请输入以http://或https://开头的地址"))},trigger:"none"}]}}},methods:{getData:function(){var e=this
return new Promise(function(t){e.$refs.outerLinkForm.validate(function(F){if(F){var u={target:"_blank",href:e.outerLinkModel.linkUrl,textValue:e.outerLinkModel.linkTitle}
t(u)}return!1})})}}})})
